##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Opinionated, Deterministic                                                    ##
##  CLIENT ERROR RESPONSE: 403                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Response for unwanted named bots/libraries whose addresses are NOT banned immediately         ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent is of search-engine bot
##    OR User-Agent is of a web browser
##  THEN
##    Skip rules for unwanted tools/bots/libraries
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}                "=1"                    [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}              "=1"                    [OR]
RewriteCond %{ENV:UA_IS_WEB_BROWSER}                    "=1"

RewriteRule .* - [S=2]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP_USER_AGENT}  "!Chrome-Lighthouse"

  RewriteCond %{HTTP_USER_AGENT}  "HeadlessChrome/\d\d\."                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "HeadlessChrome/\d\d\d\."                                           [OR]
  RewriteCond %{HTTP:sec-ch-ua}   "HeadlessChrome.*\d\d\d"

  RewriteRule .* - [R=403,L,E=NOBOT:25000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP_USER_AGENT}  "=Apache-HttpClient/4.5.2 (Java/1.8.0_151)"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Apache-HttpClient/4.5.2 (Java/1.8.0_161)"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=axios/1.8.4"                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=axios/1.11.0"                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=axios/1.13.2"                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Bun/1.3.0"                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Bun/1.3.5"                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=colly - https://github.com/gocolly/colly"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=curl-probe/1.1-fast"                                              [OR]

  ##  Block old versions of curl:
  ##  https://curl.se/download.html
  RewriteCond %{HTTP_USER_AGENT}  "=curl/7.29.0"                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=curl/7.61.1"                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=curl/7.64.1"                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=curl/7.68.0"                                                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Dart/3.7 (dart:io)"                                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=DefaultLangchainUserAgent"                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Deno/2.3.1"                                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Faraday v2.14.0"                                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Fuzz Faster U Fool v1.5.0-dev"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Fuzz Faster U Fool v2.1.0-dev"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=GuzzleHttp/7"                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=img-downloader/1.1 (+aiohttp)"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=GoConcurrentURLChecker/1.0"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Java/11.0.15"                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Nacos-Server"                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=node"                                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=scalaj-http/2.4.2"                                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Wget"                                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Wget/1.20.1 (linux-gnueabihf)"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Wget/1.21.4"                                                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^masscan-ng/"                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^okhttp/"                                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^python-httpx/"                                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^python-requests/"                                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Python-urllib/"                                                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Python/3\.\d aiohttp/"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Python/3\.\d\d aiohttp/"                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Scrapy/"                                                          [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^winHttp [0-9]+$"                                                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "EnvScanner/UltraFast"                                              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "masscan/\d"                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "python-urllib3/\d"                                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "xtate/\d"

  RewriteRule .* - [R=403,L,E=NOBOT:25000]


##
##
##
##  END OF SKIP
##
##
##
