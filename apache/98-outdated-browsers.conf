##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Probabilistic, Opinionated                                                    ##
##  CLIENT ERROR RESPONSE: 426                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Last chance to stop lying bots that have avoided detection in previous modules                ##
##                                                                                                ##
##  IMPORTANT (1)                                                                                 ##
##                                                                                                ##
##  The purpose of this module is NOT to block old browsers!                                      ##
##  It is to stop some of the lying bots that have evaded detection up to this point:             ##
##                                                                                                ##
##  IF                                                                                            ##
##    The browser is one that lying bots like to impersonate                                      ##
##    AND The browser is old enough (few real humans use it)                                      ##
##    AND The browser is NOT the last version for old operating systems                           ##
##  THEN                                                                                          ##
##    The request is denied                                                                       ##
##                                                                                                ##
##  IMPORTANT (2)                                                                                 ##
##                                                                                                ##
##  - Visitors can bypass the block by refreshing the page (see nobot-know-what-am-doing cookie). ##
##  - The error message MUST say that. E.g.:                                                      ##
##    - Please update your browser.                                                               ##
##      If you cannot or prefer not to, you can refresh the page to continue.                     ##
##                                                                                                ##
##  RESOURCES                                                                                     ##
##                                                                                                ##
##  - https://en.wikipedia.org/wiki/Template:Firefox_release_compatibility                        ##
##  - https://en.wikipedia.org/wiki/Template:Google_Chrome_release_compatibility                  ##
##  - https://support.google.com/chrome/a/answer/7100626 (Chrome browser system requirements)     ##
##                                                                                                ##
##  LAST VERSIONS of Chrome and Firefox available in OS versions:                                 ##
##                                                                                                ##
##    OS               VER         CHROME        FIREFOX                                          ##
##    --------------------------------------------------                                          ##
##    Android          4.1/4.2/4.3      71            68                                          ##
##    Android          4.4              81            68                                          ##
##    Android          5                95           143                                          ##
##    Android          6               106           143                                          ##
##    macOS            10.6             49                                                        ##
##    macOS            10.7             49                                                        ##
##    macOS            10.8             49                                                        ##
##    macOS            10.9             67            78                                          ##
##    macOS            10.10            87            78                                          ##
##    macOS            10.11           103            78                                          ##
##    macOS            10.12           103           115                                          ##
##    macOS            10.13           116           115                                          ##
##    macOS            10.14           116           115                                          ##
##    macOS            10.15           128                                                        ##
##    macOS            11.7            138                                                        ##
##    Windows          7               109           115                                          ##
##    Windows          8/8.1           109           115                                          ##
##                                                                                                ##
##  Firefox ESR versions:                                                                         ##
##                                                                                                ##
##  - Firefox 115 ESR: July 2023                                                                  ##
##  - Firefox 128 ESR: June 2024                                                                  ##
##  - Firefox 140 ESR: June 2025                                                                  ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent is of search-engine bot
##    OR User-Agent is of recent web browser
##    OR nobot-know-what-am-doing HTTP cookie is present
##  THEN
##    Skip rule for outdated browsers
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}            "=1"                        [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}          "=1"                        [OR]
RewriteCond %{ENV:UA_IS_WEB_BROWSER_NOT_OUTDATED}   "=1"                        [OR]

RewriteCond %{HTTP_COOKIE}      "nobot-know-what-am-doing=1"

RewriteRule .* - [S=1]


  RewriteCond %{HTTP:Sec-Purpose} "^$"

  ##
  ##  Chrome on Android
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 12; Pixel 6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Mobile Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Mobile Safari/537.36"          [OR]

  ##
  ##  Chrome on Linux
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.116 Safari/537.36"                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36"                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.88 Safari/537.36"                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"            [OR]

  ##
  ##  Chrome on macOS
  ##

  ##  These look fake.
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Macintosh; Apple M[1-4][^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/136\.[^ ]+ Safari/[^ ]+$"              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36"    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36"    [OR]

  ##
  ##  Chrome on Windows
  ##

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Windows NT 10[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/1[0-2][0-9]\.[^ ]+ Safari/[^ ]+$"                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36"            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36"        [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.1667.0 Safari/537.36"         [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3729.169 Safari/537.36"      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.79 Safari/537.36"       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36"       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36"      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36"       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36"          [OR]

  ##
  ##  Chrome-based
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; MI 9 Build/PKQ1.181121.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/71.0.4307.119 Mobile Safari/537.36 AWP/2.0 SogouMSE,SogouMobileBrowser/5.22.4"       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; MI 9 Build/PKQ1.181121.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.3292.160 Mobile Safari/537.36 LieBaoFast/5.10.1"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.3955.121 Safari/537.36 Core/1.70.3722.400 QQBrowser/10.5.3739.400"    [OR]

  ##  https://www.crav-ing.com/releases/
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 CravingExplorer/2.4.1" [OR]

  ##
  ##  Edge on macOS
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0"      [OR]

  ##
  ##  Edge on Windows
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Edg/86.0.622.51"      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 Edg/98.0.1108.62"     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.51 Safari/537.36 Edg/99.0.1150.30"      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36 Edg/101.0.1210.47"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0"            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.2210.133"       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0"            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Edg/122.0.0.0"            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36 Edg/138.0.0.0"            [OR]

  ##
  ##  Edge on Linux
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36 Edg/118.0.2088.76"  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36 Edg/119.0.0.0"      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0"      [OR]

  ##
  ##  Firefox on Linux
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Fedora; Linux x86_64; rv:114.0) Gecko/20100101 Firefox/114.0"                                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux i686; rv:109.0) Gecko/20100101 Firefox/121.0"                                                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/111.0"                                                   [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) Gecko/20100101 Firefox/118.0.2"                                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) Gecko/20100101 Firefox/119.0.1"                                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) Gecko/20100101 Firefox/121.0"                                                             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0"                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:114.0) Gecko/20100101 Firefox/114.0"                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:118.0.2) Gecko/20100101 Firefox/118.0.2"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:120.0.1) Gecko/20100101 Firefox/120.0.1"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:122.0) Gecko/20100101 Firefox/122.0"                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:133.0) Gecko/20100101 Firefox/133.0"                                           [OR]

  ##
  ##  Firefox on macOS
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:73.0) Gecko/20100101 Firefox/73.0"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:77.0) Gecko/20100101 Firefox/77.0"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/121.0"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:133.0) Gecko/20100101 Firefox/133.0"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:135.0) Gecko/20100101 Firefox/135.0"                                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7; rv:126.0) Gecko/20100101 Firefox/126.0"                                   [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 12.5; rv:114.0) Gecko/20100101 Firefox/114.0"                                      [OR]

  ##
  ##  Firefox on Windows
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0"                                            [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.2; rv:66.0.4) Gecko/20100101 Firefox/66.0.4"                                                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:103.0) Gecko/20100101 Firefox/103.0"                                         [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; rv:109.0) Gecko/20100101 Firefox/115.0"                                                     [OR]

  ##  2025-10-30. From Brazilian ASN (AS28573). Gecko trail is strange.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:110.0) Gecko/2491 Firefox/110.0"                                             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/117.0"                                         [OR]

  ##  These must be fake (no rv:).
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) Gecko/20100101 Firefox/118.0.2"                                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) Gecko/20100101 Firefox/119.0.1"                                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0"                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0"                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0"                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0"                                         [OR]

  ##  2025-11-25. Maybe block outright (no rv:).
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) Gecko/20100101 Firefox/121.0"                                                   [OR]

  ##
  ##  Internet Explorer
  ##

  ##  Yahoo-branded IE
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; yie11; rv:11.0) like Gecko"                                             [OR]

  ##
  ##  Opera on Windows
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 OPR/106.0.0.0"            [OR]

  ##
  ##  Safari
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Safari/605.1.15"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Safari/605.1.15"                    [OR]

  ##
  ##  Samsung Internet
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/24.0 Chrome/117.0.0.0 Mobile Safari/537.36"      [OR]

  ##
  ##  Yandex Browser on Linux
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.160 YaBrowser/22.5.3.673 Yowser/2.5 Safari/537.36"           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 YaBrowser/23.3.3.764 Yowser/2.5 Safari/537.36"                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.962 YaBrowser/23.9.1.962 Yowser/2.5 Safari/537.36"           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.120 YaBrowser/23.11.5.120.01 Safari/537.36"                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 YaBrowser/24.7.0.0 Safari/537.36"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.7204.97 YaBrowser/25.8.1.97.00 SA/3 Safari/537.36"                [OR]

  ##
  ##  Yandex Browser on Windows
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.134 YaBrowser/22.7.1.806 Yowser/2.5 Safari/537.36" [OR]

  ##
  ##  Miscellaneous
  ##

  ##  Asus ROG Phone 5
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; ASUS_I005DA Build/PI; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/133.0.6943.122 Mobile"             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Vivaldi/5.3.2679.68"                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; Zoom 3.6.0; rv:11.0) like Gecko"                                                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Vivaldi/5.3.2679.68"

  ##
  ##  REWRITE RULE
  ##

  RewriteRule .* - [R=426,L,E=NOBOT_426_GIVEN_FOR_OUTDATED_BROWSER:1]

  ##
  ##  COOKIE
  ##

  Header always set Set-Cookie "nobot-know-what-am-doing=1; Path=/; HttpOnly; Secure; SameSite=Strict; Max-Age=86400" env=NOBOT_426_GIVEN_FOR_OUTDATED_BROWSER


##
##
##
##  END OF SKIP
##
##
##
