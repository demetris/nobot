##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Opinionated, Deterministic                                                    ##
##  CLIENT ERROR RESPONSE: 402                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Response for unwanted named bots that are banned immediately                                  ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent is of a search-engine bot
##    OR User-Agent is of a web browser
##  THEN
##    Skip rule for unwanted bots
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}                "=1"                    [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}              "=1"                    [OR]
RewriteCond %{ENV:UA_IS_WEB_BROWSER}                    "=1"

RewriteRule .* - [S=1]


  ##  Example matches:
  ##  - "Mozilla/5.0 (bang2012@tutanota.de)"
  ##  - "Mozilla/5.0 (rondo2012@atomicmail.io)"
  ##  - "Mozilla/5.0 (makenoise@tutanota.de)"
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^\s@]+@[^\s)]+\)$"                                                                    [OR]

  ##  2025-11-01. Has ad for Floppydata on its homepage.
  RewriteCond %{HTTP_USER_AGENT}  "=2ip bot/1.1 (+https://2ip.io)"                                                                        [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=abuse.xmco.fr"                                                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=AliyunSecBot/Aliyun (AliyunSecBot@service.alibaba.com)"                                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Automattic Analytics Crawler/0.2; http://wordpress.com/crawler/"                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=AwarioSmartBot/1.0 (+https://awario.com/bots.html; bots@awario.com)"                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Brightbot 1.0"                                                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Buck/2.5.5; (+https://app.hypefactors.com/media-monitoring/about.html)"                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Buck/2.5.6; (+https://app.hypefactors.com/media-monitoring/about.html)"                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=CGrab/v6.4.3"                                                                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=cypex.ai/scanning Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) Chrome/126.0.0.0 Safari/537.36"     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=DataDome Discovery HTTP Client"                                                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=DomainStatsBot/1.0 (https://domainstats.com/pages/our-bot)"                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Feedspot/1.0 (+https://www.feedspot.com/fs/fetcher; like FeedFetcher-Google)"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=GolamV2-Crawler/1.0"                                                                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=loli_spider"                                                                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=MercuryLeads/1.0 (+https://mercuryleads.io/crawler/)"                                                 [OR]

  ##  https://developers.facebook.com/docs/sharing/webmasters/web-crawlers/
  ##  “The Meta-ExternalAgent crawler crawls the web for use cases such as
  ##  training AI models or improving products by indexing content directly.”
  RewriteCond %{HTTP_USER_AGENT}  "=meta-externalagent/1.1"                                                                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=meta-externalagent/1.1 (+https://developers.facebook.com/docs/sharing/webmasters/crawler)"            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; AwarioBot/1.0; +https://awario.com/bots.html)"                               [OR]

  ##  Adding this for two reasons:
  ##  1. Don’t need it.
  ##  2. It seems that malicious bots impersonate it.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; CensysInspect/1.1; +https://about.censys.io/)"                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; DotBot/1.1; http://www.opensiteexplorer.org/dotbot, help@moz.com)"           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; ev-crawler/1.0; +https://headline.com/legal/crawler)"                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; LLMSE/1.3.31; +https://llmse.ai/about)"                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; LumeWebScan/2.0; +https://lumeweaver.com/)"                                  [OR]

  ##  2025-11-25. No idea if reciprocal or not. No way to verify if fake or not either: Does not publish ranges.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; MakeMerryBot/1.0; +https://makemerry.app/bots)"                              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; MixrankBot; crawler@mixrank.com)"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; MJ12bot/v1.4.8; http://mj12bot.com/)"                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; MJ12bot/v2.0.4; http://mj12bot.com/)"                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; ModatScanner/1.1; +https://modat.io/)"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; ModatScanner/1.2; +https://modat.io/)"                                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; NaaraaBot/1.0; +https://www.naaraa.com)"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; Odin; https://docs.getodin.com/)"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; SemrushBot-BA; +http://www.semrush.com/bot.html)"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; SemrushBot-OCOB/1; +https://www.semrush.com/bot/)"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; SemrushBot-SA/0.97; +http://www.semrush.com/bot.html)"                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; SemrushBot/3~bl; +http://www.semrush.com/bot.html)"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; SemrushBot/7~bl; +http://www.semrush.com/bot.html)"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; SERankingBacklinksBot/1.0; +https://seranking.com/backlinks-crawler)"        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; Website-info.net-Robot; https://website-info.net/robot)"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; WordPressCommentBot/1.0; +https://www.53278.xyz/)"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; wpbot/1.3; +https://forms.gle/ajBaxygz9jSR8p8G9)"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; wpbot/1.4; +https://forms.gle/ajBaxygz9jSR8p8G9)"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; WP-Detector/1.0)"                                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; ZenixOpsBot/3.0; +https://zenixops.com)"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible;PetalBot;+https://webmaster.petalsearch.com/site/petalbot)"                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (keys-so-bot)"                                                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36 (compatible; SMTBot/1.0; +http://www.similartech.com/smtbot)"  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; PerplexityBot/1.0; +https://perplexity.ai/perplexitybot)" [OR]
  
  ##  2026-02-09. Bot page is 404.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko; compatible; Amazing-SearchBot/0.1; +https://amazing.com/bot.html) Chrome/119.0.6045.214 Safari/537.36"                         [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "=Nextcloud Server Crawler"                                                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=NiueBot/0.2"                                                                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Pandalytics/2.0 (https://domainsbot.com/pandalytics/)"                                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=panscient.com"                                                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Photon/1.0"                                                                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=ProductWatcher/1.0 (by /u/ProductWatcher)"                                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=RecordedFuture Global Inventory Crawler"                                                              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Riddler (http://riddler.io/about)"                                                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=SEMrushBot"                                                                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=SemrushBot-EO"                                                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=SEOBot/1.0"                                                                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=SEOIndexBot/1.0 (+https://website-seo-check.com/bot-info)"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Tarassut 1.0"                                                                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=TerraCotta https://github.com/CeramicTeam/CeramicTerracotta"                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Timpibot/0.9 (+http://www.timpi.io)"                                                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Turaco Labs ThreatView Security Auditor (threatview.app)"                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=vcache-crawler/0.1"                                                                                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=WanScannerBot/1.1"                                                                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=YisouSpider"                                                                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=ZoominfoBot (zoominfobot at zoominfo dot com)"                                                        [OR]

  ##  2025-11-14. Not sure about Timpi. May unblock at a later time.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; Timpibot/0.8; +http://www.timpi.io)"                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Timpibot/1.0 (+http://timpi.io/crawler)"                                                              [OR]

  ##
  ##
  ##  UA starts with
  ##
  ##

  RewriteCond %{HTTP_USER_AGENT}  "^LinkupBot/\d"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^LinkupCrawler/\d"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^MetaInspector/\d"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Sogou web spider/\d"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^StingrayBot/\d"                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Turnitin"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Websuse\.de/1\.0"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^WordPress\.com;"                              [OR]

  ##
  ##
  ##  UA ends with
  ##
  ##

  RewriteCond %{HTTP_USER_AGENT}  "360Spider$"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "BitSightBot/1\.0$"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "WP\.com mShots$"                               [OR]

  ##
  ##
  ##  UA includes
  ##
  ##

  RewriteCond %{HTTP_USER_AGENT}  "compatible; Amazonbot/"                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; BacklinksExtendedBot"              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; Barkrowler/"                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; BitSightBot/"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; BLEXBot/"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; Bytespider;"                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; ClaudeBot/"                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; CMS-Checker/"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; DataForSeoBot/"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; Dataprovider\.com"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; Example3/"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; FormFinder/"                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; GenomeCrawlerd/"                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; GoParserBot/"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; GoRedirectChecker/"                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; GPTBot/"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; HaloBot/"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; intelx\.io_bot"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; NetcraftSurveyAgent/"              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; Nicecrawler/"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; ORT/v"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; PetalBot;"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; ShapBot/"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; ShopScanner/"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; Spider/"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; SurdotlyBot/"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; TikTokSpider/"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "compatible; VelenPublicWebCrawler/"            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "Bidtellect/"                                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "CheckMarkNetwork/"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "Custom-AsyncHttpClient"                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "Flyriverbot/"                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "Keydrop\.io/"                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "l9(explore|scan|tcpid)/"                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "SemrushBot;"                                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "serpstatbot/"                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "sexy-spider/"                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "Thinkbot/"                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "trendictionbot0\.5\.0; trendiction search;"

  RewriteRule .* - [R=402,L]


##
##
##
##  END OF SKIP
##
##
##
