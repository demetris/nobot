##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Deterministic                                                                 ##
##  CLIENT ERROR RESPONSE: 451                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Response for requests with unexpected Accept-Encoding                                         ##
##  or unexpected Accept-Encoding combined with other unexpected field values                     ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent string is of a search-engine bot
##  THEN
##    Skip all rules for Accept-Encoding
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}                "=1"                    [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}              "=1"

RewriteRule .* - [S=52]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  IF
  ##    HTTP method is HTTP/2 (the connection is secure)
  ##    AND User-Agent is of browser that advertises “zstd” in Accept-Encoding
  ##    AND Accept-Encoding is not malformed
  ##  THEN
  ##    Skip all rules for Accept-Encoding
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br, zstd"

  RewriteCond %{ENV:UA_IS_CHROME_123_TO_199}              "=1"                    [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_123_TO_199}        "=1"                    [OR]
  RewriteCond %{ENV:UA_IS_FIREFOX_126_TO_199}             "=1"                    [OR]
  RewriteCond %{ENV:UA_IS_SAFARI_26_3_TO_29}              "=1"

  RewriteRule .* - [S=51]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  IF
    ##   Accept-Encoding is not empty
    ##  THEN
    ##    Skip rules for empty Accept-Encoding
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "!^$"

    RewriteRule .* - [S=5]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  NO-Encoding
      ##
      ##  Accept-Encoding is missing.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_79}"                                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_5_TO_10}"                  [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_11}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##  NO-Encoding-NO-Language
      ##
      ##  - Accept-Encoding is missing.
      ##  - Accept-Language is missing.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "^$"
      RewriteCond %{HTTP:Accept-Language} "^$"

      RewriteCond %{ENV:UA_IS_CHROME}                         "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_EDGE_DESKTOP}                   "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_FIREFOX}                        "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_SAFARI}                         "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_SAMSUNG_INTERNET}               "=1"                    [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_12_TO_18_VER_73_TO_149}"           [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${EDGE_12_TO_18}"                              [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_5_TO_6}"                               [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_4_TO_12}"                              [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_15_TO_108_ON_CHR_28_TO_122}"   [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_WINDOWS_3_TO_5}"                      [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${UC_BROWSER_13_4_ON_CHR_89}"                  [OR]

      RewriteCond %{HTTP_USER_AGENT}  "^Opera/"                                       [OR]

      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/1[0-4][0-9]\.[^ ]+ Safari/[^ ]+ Vivaldi/[^ ]+$"               [OR]
      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/125\.[^ ]+ Safari/[^ ]+ Brave/[^ ]+$"                         [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 11; RMX2195) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.210 Mobile Safari/537.36 OPR/75.2.3995.72468"   [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 4.2.2; he-il; GT-S7580 Build/JDQ39) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"       [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 10; en-US; CPH2015) AppleWebKit/537.36 (KHTML, like Gecko) UCBrowser/13.5.8.1311 Mobile Safari/537.36"             [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 5.1; rv:68.9) Gecko/20100101 Goanna/4.5 Firefox/68.9 Mypal/28.9.2"                                                        [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; U; Linux ppc64; en-US; rv:1.8.1.14) Gecko/20080418 Ubuntu/7.10 (gutsy) Firefox/2.0.0.14"                                        [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.0.7) Gecko/2009031120 Mandriva/1.9.0.7-0.1mdv2009.0 (2009.0) Firefox/3.0.7"                      [OR]

      ##  Yandex Start
      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 7.0; PMT3151_3G Build/NRD90M) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.117 Mobile Safari/537.36 YaApp_Android/10.61/apad YaSearchBrowser/10.61"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Accept-NO-Encoding
      ##
      ##  - Accept-Encoding is missing.
      ##  - Accept is missing for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_URI}          "=/"

      RewriteCond %{HTTP:Accept}          "^$"
      RewriteCond %{HTTP:Accept-Encoding} "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_92}"                                  [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_120}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Accept-NO-Encoding
      ##
      ##  - Accept-Encoding is missing.
      ##  - Accept value is unexpected for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "^$"

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept}          "=*/*"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_100_TO_129}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  - Accept-Encoding is missing.
      ##  - Sec-CH-UA-Platform is present while two other hints are missing.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding}       "^$"

      RewriteCond %{HTTP:Sec-CH-UA}             "^$"
      RewriteCond %{HTTP:Sec-CH-UA-Mobile}      "^$"
      RewriteCond %{HTTP:Sec-CH-UA-Platform}    "!^$"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_143}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


    ##
    ##
    ##
    ##  END OF SKIP
    ##
    ##
    ##


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  IF
    ##    Accept-Encoding is not “gzip”
    ##  THEN
    ##    Skip rules for “gzip” Accept-Encoding
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "!^gzip$"

    RewriteRule .* - [S=13]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected. Should have more than “gzip”.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{ENV:UA_IS_FIREFOX_0_TO_43}                "=1"                    [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_35}"                                  [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_109}"                                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_93}"                                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_5}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##  NO-Accept-UNEXPECTED-Encoding-UNEXPECTED-Language
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have more than “gzip”.
      ##  - Accept-Language value is uncommon.
      ##  - Accept is missing
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"
      RewriteCond %{HTTP:Accept-Language} "=*"

      RewriteCond %{HTTP:Accept}          "^$"

      RewriteCond %{ENV:UA_IS_CHROME_0_TO_89}                 "=1"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##  UNEXPECTED-Accept-UNEXPECTED-Encoding-UNEXPECTED-Language
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have more than “gzip”.
      ##  - Accept-Language value is uncommon.
      ##  - Accept value is unexpected for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"
      RewriteCond %{HTTP:Accept-Language} "=*"

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept}          "=*/*"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_118}"                                [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_13_TO_14}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Accept-UNEXPECTED-Encoding
      ##
      ##  - Accept-Encoding value is unexpected. Should be more than “gzip”.
      ##  - Accept value is unexpected for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept}          "=*/*"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_65}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Accept-UNEXPECTED-Encoding
      ##
      ##  - Accept-Encoding value is unexpected. Should be more than “gzip”.
      ##  - Accept value is missing for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept}          "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_136}"                                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_16}"                           [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Mobile Safari/537.36 AlohaBrowser/7.13.0"                                      [OR]
      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 16_0_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 YaBrowser/25.12.3.802.10 SA/3 Mobile/15E148 Safari/604.1"  [OR]
      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 17_0_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/604.1 OPX/3.1.1"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Accept-UNEXPECTED-Encoding
      ##
      ##  - Accept-Encoding value is unexpected. Should be more than “gzip”.
      ##  - Accept value is unexpected for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept}          "=text/html,application/xhtml+xml"

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_MOBILE_80_ON_CHR_120}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Encoding
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have more than “gzip”.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_48}"                                  [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_134}"                                [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${WECHAT_ON_CHR_66}"                           [OR]

      ##  This must be fake (unreduced Chrome version).
      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.6943.141 Safari/537.36"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have more than “gzip”.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"
      RewriteCond %{HTTP:Sec-Purpose}     "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_103}"                                [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_25_12_ON_CHR_142}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have more than “zip”.
      ##  - Sec-Fetch-Dest is unexpectedly present.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"

      RewriteCond %{HTTP:Sec-Fetch-Dest}  "!^$"

      RewriteCond %{HTTP_USER_AGENT}      "${SAFARI_DESKTOP_13_TO_15}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"

      RewriteCond %{REQUEST_URI}          "=/"

      RewriteCond %{HTTP:Accept-Encoding} "=gzip"
      RewriteCond %{HTTP:Sec-CH-UA}       "^$"
      RewriteCond %{HTTP:Sec-CH-Mobile}   "^$"
      RewriteCond %{HTTP:Sec-CH-Platform} "^$"
      RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_111}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip"
      RewriteCond %{HTTP:Accept}          "^$"
      RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

      RewriteCond %{HTTP_USER_AGENT}      "${SAFARI_MOBILE_17}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip"
      RewriteCond %{HTTP:Accept}          "=*/*"
      RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

      RewriteCond %{HTTP_USER_AGENT}      "${CHROME_120_TO_129}"                      [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${EDGE_DESKTOP_120_TO_129}"                [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${FIREFOX_120_TO_129}"                     [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${SAFARI_DESKTOP_17}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip"
      RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

      RewriteCond %{HTTP_USER_AGENT}      "${SAMSUNG_INTERNET_23_ON_CHR_115}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


    ##
    ##
    ##
    ##  END OF SKIP
    ##
    ##
    ##


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  IF
    ##   Accept-Encoding has “br” or “zstd”
    ##  THEN
    ##    Skip rules for Accept-Encoding without “br” or “zstd”
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "(br|zstd)"

    RewriteRule .* - [S=13]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should not have “sdch” in Chrome 59 and newer.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, sdch"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_83}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##  - Accept-Encoding value “identity” is unexpected for root request.
      ##  - Accept value is unexpected for root request.
      ##  - Fetch metadata (3 fields) are all missing for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_URI}          "=/"

      RewriteCond %{HTTP:Accept-Encoding} "=identity"
      RewriteCond %{HTTP:Accept}          "=*/*"
      RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_80_TO_89}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##  - Accept-Encoding value “identity” is unexpected for root request.
      ##  - Accept value is unexpected for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept-Encoding} "=identity"
      RewriteCond %{HTTP:Accept}          "=*/*"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_70_TO_79}"                           [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_21_3_YOWSER_ON_CHR_89}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  Accept-Encoding value “identity” is unexpected for root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Accept-Encoding} "=identity"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_90}"                                  [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_92}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##  Accept-Encoding value is malformed.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=*,identit,deflat,compres"                 [OR]
      RewriteCond %{HTTP:Accept-Encoding} "=b,identit,deflat"                         [OR]
      RewriteCond %{HTTP:Accept-Encoding} "=compres,identit,b,"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: 10
      ##
      ##  Accept-Encoding value is wrong.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=UTF-8"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_110_TO_119}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have space after comma.
      ##  - Should have “br” as well if over TLS.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip,deflate"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_104}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD (single but strong signal)
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have space after comma.
      ##    - Should have “br” as well over TLS.
      ##    
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip,deflate"

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.2 Safari/605.1.15"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have “br” as well over TLS.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_13}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have more than “gzip, deflate” over TLS.
      ##  - Fetch metadata (3 fields) are all missing.
      ##  - Client hints (3 fields) are all missing.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"
      RewriteCond %{HTTP:Sec-CH-UA}             "^$"
      RewriteCond %{HTTP:Sec-CH-Mobile}         "^$"
      RewriteCond %{HTTP:Sec-CH-UA-Platform}    "^$"
      RewriteCond %{HTTP:Sec-Fetch-Dest}        "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}        "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}        "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_130}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have “br” as well if over TLS.
      ##  - Sec-Fetch-Site value is unexpected.
      ##    - Should be “cross-site” if REFERER was Google Search.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"
      RewriteCond %{HTTP_REFERER}         "=https://www.google.com/"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "=none"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_113}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have “br” as well if over TLS.
      ##  - Fetch metadata (3 fields) are all missing on root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"
      RewriteCond %{REQUEST_URI}          "=/"
      RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
      RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_94_ON_CHR_108}"                [OR]

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 14_4_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3.1 Safari/605.1.15"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have more than “gzip” or “gzip, deflate” on HTTPS.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "^(gzip|gzip, deflate|deflate, gzip)$"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_122}"                                [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_28_TO_85_ON_CHR_41_TO_99}"     [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360SE_ON_CHR_80_TO_99}"                 [OR]

      ##  Do NOT add Safari below 18! Sometimes it does not have “br” in Accept-Encoding.
      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_18}"                          [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_18}"                           [OR]

      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/80\.[^ ]+ Safari/[^ ]+ Kinza/[^ ]+$"                          [OR]

      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/73\.[^ ]+ UBrowser/[^ ]+ Safari/[^ ]+$"                       [OR]

      ##  SUSPICIOUS!
      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/125.0.2535.67 Safari/537.36"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


    ##
    ##
    ##
    ##  END OF SKIP
    ##
    ##
    ##


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  IF
    ##   Accept-Encoding does not have “br”
    ##  THEN
    ##    Skip rules for Accept-Encoding with “br”
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "!br"

    RewriteRule .* - [S=10]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is wrong and unexpected for both HTTP and HTTPS.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=zstd,gzip,deflate,br"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_106}"                                 [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_136}"                                 [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_142}"                                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_142}"                                [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_143}"                                [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_26}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should not have “br” on plain HTTP.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=http"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_62}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have spaces after the commas.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip,deflate,br"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_91}"                                  [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_26}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Order is wrong.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "=gzip, br, zstd, deflate"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_130_TO_139}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##
      ##  Accept-Encoding value is unexpected for both HTTP and HTTPS.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip, compress, deflate, br"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_80_TO_149}"                           [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_100_TO_149}"                    [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_100_TO_149}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have “zstd” as well.
      ##
      ##  NOTES
      ##  - The Sec-Purpose condition is for the Google prefetcher (Sec-Purpose: prefetch;anonymous-client-ip).
      ##    It seems the prefetcher does not pass the exact Accept-Encoding value the browser would send.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"
      RewriteCond %{HTTP:Sec-Purpose}     "^$"

      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

      RewriteCond %{ENV:UA_IS_CHROME_123_TO_199}              "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_123_TO_199}        "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_FIREFOX_126_TO_199}             "=1"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Should have “zstd” as well on HTTPS.
      ##  - Sec-CH-UA is unexpectedly missing on root request.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{SERVER_PROTOCOL}      "=HTTP/2.0"

      RewriteCond %{REQUEST_URI}          "=/"

      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"
      RewriteCond %{HTTP:Sec-CH-UA}       "^$"

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_126_ON_CHR_142}"               [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_24_6_TO_25_12_ON_CHR_124_TO_142}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected for plain HTTP.
      ##  - Should have spaces after commas.
      ##  - Should not have “br” on plain HTTP.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=http"

      RewriteCond %{HTTP:Accept-Encoding} "=gzip,deflate,br"

      RewriteCond %{HTTP_USER_AGENT}      "${CHROME_120}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected. Should not have br.
      ##
      ##  RESOURCES
      ##  - https://caniuse.com/brotli
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

      RewriteCond %{ENV:UA_IS_FIREFOX_0_TO_43}                "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_CHROME_0_TO_49}                 "=1"                    [OR]
      RewriteCond %{ENV:UA_IS_SAFARI_3_TO_10}                 "=1"                    [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_7_VER_38}"                         [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_5_TO_10}"                  [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_11}"                       [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_4_TO_12}"                              [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_WINDOWS_3_TO_5}"                      [OR]

      RewriteCond %{HTTP_USER_AGENT}  "^Opera/8\."                                    [OR]
      RewriteCond %{HTTP_USER_AGENT}  "^Opera/9\."

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Encoding-UNEXPECTED-Language
      ##
      ##  - Accept-Encoding value is unexpected.
      ##    - Order is uncommon.
      ##    - Should not have “br” on plain HTTP.
      ##    - Should have “zstd” as well on HTTPS.
      ##  - Accept-Language value is uncommon.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "=br, gzip, deflate"

      RewriteCond %{HTTP:Accept-Language} "=*"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_127}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


    ##
    ##
    ##
    ##  END OF SKIP
    ##
    ##
    ##


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  IF
    ##   Accept-Encoding does not have “zstd”
    ##  THEN
    ##    Skip rules for Accept-Encoding with “zstd”
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "!zstd"

    RewriteRule .* - [S=3]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##  CONFIDENCE: TBD
      ##  UNEXPECTED-Encoding
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should not have “zstd”.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{HTTP:Accept-Encoding} "zstd"

      RewriteCond %{ENV:UA_IS_CHROME_0_TO_122}            "=1"                        [OR]
      RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_80_TO_122}     "=1"                        [OR]
      RewriteCond %{ENV:UA_IS_FIREFOX_0_TO_125}           "=1"                        [OR]
      RewriteCond %{ENV:UA_IS_SAFARI_10_TO_18}            "=1"                        [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_60_TO_69_ON_ANDROID_WV}"              [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_11_TO_18_VER_ANY}"                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${EDGE_12_TO_18}"                              [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_103}"                            [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${FXIOS_IOS_14_TO_18_VER_110_TO_139}"          [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_5_TO_10}"                  [OR]
      RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_11}"                       [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_15_TO_108_ON_CHR_28_TO_122}"   [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SAMSUNG_INTERNET_10_TO_29}"                  [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${SEAMONKEY_2_0_TO_2_49}"                      [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_23_5_YOWSER_ON_CHR_114}"              [OR]

      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Mac[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Version/26\.0 Safari/[^ ]+$"                                      [OR]
      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(i[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Version/26\.0 Mobile/[^ ]+ Safari/[^ ]+$"                           [OR]

      ##  Vivaldi

      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/1[0-1][0-9]\.[^ ]+ Safari/[^ ]+ Vivaldi/[^ ]+$"               [OR]
      RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/121\.[^ ]+ Safari/[^ ]+ Vivaldi/[^ ]+$"                       [OR]

      ##  Other

      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 12; redroid12_arm64 Build/SQ1D.220205.004; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/122.0.6261.119 Mobile Safari/537.36 uni-app"   [OR]
      RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 4.4.2; en-US; HM NOTE 1W Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 UCBrowser/11.0.5.850 U3/0.8.0 Mobile Safari/534.30"

      ##
      ##  REWRITERULE
      ##

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should have “br” as well.
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=https"
      RewriteCond %{HTTP:Accept-Encoding} "=deflate, gzip, zstd"

      RewriteCond %{HTTP_USER_AGENT}  "${CHROME_136}"                                 [OR]

      RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_125}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
      ##
      ##  Accept-Encoding value is unexpected.
      ##  - Should not have “br” or “zstd” on plain HTTP (or at all for some versions).
      ##
      ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

      RewriteCond %{REQUEST_SCHEME}       "=http"
      RewriteCond %{HTTP:Accept-Encoding} "^(gzip, deflate, br, zstd|gzip, deflate, zstd)$"

      RewriteCond %{HTTP_USER_AGENT}      "${CHROME_80_TO_149}"                       [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${EDGE_DESKTOP_80_TO_149}"                 [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${FIREFOX_44_TO_149}"                      [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${INTERNET_EXPLORER_5_TO_10}"              [OR]
      RewriteCond %{HTTP_USER_AGENT}      "${INTERNET_EXPLORER_11}"                   [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${OPERA_DESKTOP_99_ON_CHR_114}"            [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${SAFARI_DESKTOP_10_TO_18}"                [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${SAFARI_MOBILE_10_TO_18}"                 [OR]

      RewriteCond %{HTTP_USER_AGENT}      "${YANDEX_23_5_YOWSER_ON_CHR_114}"

      RewriteRule .* - [R=451,L,E=NOBOT:64000]


    ##
    ##
    ##
    ##  END OF SKIP
    ##
    ##
    ##


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  Acccept-Encoding value is malformed.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, gzip, deflate"

    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_90}"

    RewriteRule .* - [R=451,L,E=NOBOT:64000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##  CONFIDENCE: 10
    ##  UNEXPECTED-Encoding
    ##
    ##  Accept-Encoding value is malformed.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Accept-Encoding} "^Accept-Encoding:"

    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_70}"

    RewriteRule .* - [R=451,L,E=NOBOT:64000]


  ##
  ##
  ##
  ##  END OF SKIP
  ##
  ##
  ##


##
##
##
##  END OF SKIP
##
##
##
