##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Deterministic                                                                 ##
##  CLIENT ERROR RESPONSE: 451                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  @TODO                                                                                         ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##  THEN
##    Skip the module
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}                "=1"

RewriteRule .* - [S=3]


  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Lin[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/9[0-9]\.0\.0\.0 Safari/[^ ]+$"                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Windows NT 11[^)]+\) AppleWebKit/[^ ]+ \(KHTML[^o]+\) Chrome/[1-9][0-9]\."                                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Windows NT 11[^)]+\) AppleWebKit/[^ ]+ \(KHTML[^o]+\) Chrome/1[0-4][0-9]\."                                                [OR]

  ##  Has double space, and no parenthesis.
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0  Windows NT 10\.0"                                                                                                           [OR]

  ##  Format of frozen OS version is wrong for Firefox.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7; rv:125.0.1) Gecko/20100101 Firefox/125.0.1"                                               [OR]

  ##
  ##  Safari 17.9, 17.10, 17.14 do not exist.
  ##

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.9 Mobile/15E148 Safari/604.1"         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.10 Safari/605.1.1"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.10 Safari/605.1.15"                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.14 Safari/605.1.15"                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/170.1"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/180.1"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/184.1"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 13_5) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Safari/260.1"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/172.1"  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/180.1"  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.0 Mobile/15E148 Safari/184.1"  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; Xbox; Xbox One) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 Edge/44.18363.8131"   [OR]

  ##
  ##  Browser version in User-Agent unreduced: Chrome
  ##

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((Mac|Win)[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/1[2-3][0-9]\.0\.[0-9]{4}\.[^ ]+ Safari/[^ ]+$"                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 13_6_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.88 Safari/537.36"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.5481.100 Safari/537.36"               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.88 Safari/537.36"                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/145.0.7632.67 Safari/537.36"                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.134 Safari/537.36"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.1151.187 Safari/537.36"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.3762.189 Safari/537.36"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.4017.175 Safari/537.36"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.7444.176 Safari/537.36"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.7499.40 Safari/537.36"                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/134.0.2820.19 Safari/537.36 Edg/134.0.2820.19"

  ##
  ##  REWRITE RULE
  ##

  RewriteRule .* - [R=451,L,E=NOBOT:61000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  IF
  ##    User-Agent is of search-engine bot
  ##    OR User-Agent has a valid browser value
  ##  THEN
  ##    Skip rule for unexpected values in User-Agent
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}      "=1"                            [OR]
  RewriteCond %{ENV:UA_IS_WEB_BROWSER}            "=1"

  RewriteRule .* - [S=1]


    ##
    ##  Made up: Strange pattern
    ##

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Agency/97.8.8247.48"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Viewer/99.9.8853.8"                       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Agency/93.8.2357.5"                       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Agency/98.8.8175.80"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36 Config/92.2.2788.20"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36 Viewer/98.9.8301.82"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36 Herring/90.1.1633.8"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36 Unique/97.7.7196.69"                      [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0 Viewer/99.9.9009.89"        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36 Edg/121.0.0.0 Unique/97.7.7286.70"        [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0 Config/91.2.2121.13"                                                     [OR]

    ##
    ##  Made up: General
    ##

    RewriteCond %{HTTP_USER_AGENT}  "^mozilla/3\.0 \(Windows NT 6\.1"                                   [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Windows NT; FreeBSD; Debian; Android\)"            [OR]

    ##  User-Agent is quoted.
    RewriteCond %{HTTP_USER_AGENT}  "^'Mozilla/"                                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  '^"Mozilla/'                                                        [OR]

    ##  Has double Mozilla with long version number
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/[4-5]\.0\d+ Mozilla/"                                     [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 Mozilla/5\.0 \("                                     [OR]

    ##  2026-02-15. Maybe should not be blocking this
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/1"                                                        [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozlila"                                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^User-Agent:Mozilla/"                                              [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozila/"                                                          [OR]

    ##  Could be malicious.
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla'"                                                         [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0\(Windows"                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.g"                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/6"                                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/[0-9][0-9]\."                                             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^User-Agent:Mozilla/"                                              [OR]

    RewriteCond %{HTTP_USER_AGENT}  "={USER_AGENT}"                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Cloudflare"                                                       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=firefox"                                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Linux Mozilla"                                                    [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=desktop"                                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=M"                                                                [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla"                                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64)"                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=pc"                                                               [OR]

    ##
    ##  Made up: Chrome
    ##

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/4\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/[0-9]\.[^ ]+ Safari/[^ ]+$"                                                   [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Chrome/91\.[^ ]+$"                                                                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(iPhone; CPU iPhone OS 11[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/[1-9][0-9]\.[^ ]+ Safari/537\.36$"                    [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Mac[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/[1-9][0-9]\.[^ ]+$"                                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Win[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\)Chrome"                                                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Win[^)]+\) Chrome/1[0-3][0-9]\.[^ ]+ Safari/537\.36$"                                                                      [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Chrome/15.0.860.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/533.20.25 (KHTML, like Gecko) Version/15.0.860.0"                       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 12) Chrome/111.0 Mobile Safari/537.36"                                                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 12) Chrome/112.0"                                                                                             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/524.34"                [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.9999.0 Safari/537.36 Auction"         [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (PPC) AppleWebKit/516.0 (KHTML, live Gecko) Chrome/14.0540.536 Safari/516"                                                    [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; Win64; x64) Chrome/115.0.0.0 Safari/537.36"                                                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.2;en-US) AppleWebKit/537.32.36 (KHTML, live Gecko) Chrome/55.0.3048.84 Safari/537.32"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 3918681 like Gecko) Chrome/60.0.3112.113 Safari/537.36"                       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/131.0.0.0 Safari/537.36"                                              [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/120.0.0.0"                                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 Chrome/143.0.0.0"                                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120"                                                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0.0.0"                                                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 5.1; de-DE) Chrome/4.0.223.3 Safari/532.2"                                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.37"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121 Safari/537.36"                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) Chrome/19.0.1084.9 Safari/536.5"                                                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; U; Linux x86_64; en-US) AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.107 Safari/534.13 v1333515017.9196"       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.131 Safari/537.36"                                                    [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 ArchLinux (X11; U; Linux x86_64; en-US) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.100"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 Slackware/13.37 (X11; U; Linux x86_64; en-US) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.41"                       [OR]

    ##  Has extra space before AppleWebKit.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US)  AppleWebKit/534.13 (KHTML, like Gecko) Chrome/9.0.597.0 Safari/534.13"                   [OR]

    ##  Versions are all over the place.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 14_2_1 like Mac OS X) AppleWebKit/535.0 (KHTML, like Gecko) CriOS/55.0.881.0 Mobile/64S777 Safari/535.0"       [OR]

    ##
    ##  Made up: Edge
    ##

    ##  Edge 18 should not have Chrome above 70.
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/([8-9][0-9]|7[1-9])\.[^ ]+ Safari/[^ ]+ Edge/18\.[^ ]+$"                      [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Edge/8[0-9]\.0\.0\.0 Safari/[^ ]+$"                                                  [OR]

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Windows NT 11[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Edg/1[0-9][0-9]\."                                                      [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Mac OS X 13_2) AppleWebKit/537.36 (KHTML, like Gecko) Edge/129.0 Safari/537.36"                                              [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/82.0.0.0 Safari/537.36"                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome Safari/537.36 Edg/120.0.0.0"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36 Edg/140.0.0.0;"           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/91.0.864.59"                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/119.0.2151.97"                                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/114.0.1823.79 Safari/537.36"                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/120.0.0.0 Safari/537.36"                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/120.0.2210.91"                                      [OR]

    ##
    ##  Made up: Edge Android
    ##

    ##  2026-02-16. This must be fake. Edge Android 42 uses a newer version on Chromium.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 7.1.1; OPPO R9sk) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3755.70 Mobile Safari/537.36 EdgA/42.0.2.3819"   [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 EdgA/126.0.0.0"           [OR]

    ##
    ##  Made up: Firefox
    ##

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((Mac|Win|X11)[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Firefox/[7-9][0-9]\.0\.0\.0 Safari/[^ ]+$"                              [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((Mac|Win|X11)[^)]+\) Gecko/[^ ]+ Firefox$"                                                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((Mac|Win|X11)[^)]+\) Gecko Firefox/[0-9]\."                                                                                [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((Mac|Win|X11)[^)]+\) Gecko/ Firefox/([0-9]|[1-9][0-9])\."                                                                  [OR]

    ##  Firefox with lowercase f.
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^:]+:[0-9.]{3,}\) Gecko/[^ ]+ firefox/([1-9][0-9]|[0-9])\.[^ ]+$"                                                         [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:{version}.0) Gecko/20100101 Firefox/133.0"                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:{version}.0) Gecko/20100101 Firefox/135.0"                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15) Gecko/20100101 Firefox/119.0.1"                                                             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15) Gecko/20100101 Firefox/120.0.1"                                                             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15) Gecko/20100101 Firefox/121.0"                                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15) Gecko/20100101 Firefox/122.0"                                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (platform; rv:geckoversion) Gecko/geckotrail Firefox/firefoxversion"                                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; rv:2.0b6pre) Gecko/20100903 Firefox/4.0b6pre Firefox/4.0b6pre"                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; rv:25.0) Gecko/20100101 Firefox/2X.0"                                                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; U;WOW64; de;rv:11.0) Gecko Firefox/11.0"                                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) Gecko/20100101 Firefox/122.0"                                                                   [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.3a3pre) Gecko/20100306 Firefox3.6 (.NET CLR 3.5.30729)"                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; FreeBSD i686) Firefox/3.6"                                                                                              [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) Firefox/117.0"                                                                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) Gecko/20100101 Firefox/117.0"                                                                             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64) Gecko/Firefox"                                                                                    [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 Firefox"                                                                                                                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 Firefox/33.0"                                                                                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 Firefox/35.0"                                                                                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 Gecko/20100101 Firefox/145.0"                                                                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 X11; Ubuntu; Linux x86_64; rv:126.0 Gecko/20100101 Firefox/126.0"                                                             [OR]

    ##  "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_8; rv:1.9.2.20) Gecko/9012-05-06 11:35:04.566162 Firefox/15.0"
    ##  "Mozilla/5.0 (Macintosh; PPC Mac OS X 10_7_7; rv:1.9.5.20) Gecko/4076-03-01 05:21:47.331367 Firefox/3.8"
    ##  "Mozilla/5.0 (X11; Linux i686; rv:1.9.5.20) Gecko/8230-04-20 13:46:29.500763 Firefox/4.0"
    ##  "Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/7976-01-14 05:26:28.095795 Firefox/3.6.16"
    ##  "Mozilla/5.0 (X11; Linux x86_64; rv:1.9.6.20) Gecko/9377-05-23 04:20:42.414856 Firefox/3.8"
    ##  "Mozilla/5.0 (Windows NT 5.1; so-SO; rv:1.9.0.20) Gecko/6126-02-15 04:25:26.725616 Firefox/4.0"
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ [.:0-9]{15} Firefox/[0-9]\.[^ ]+$"                                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ [.:0-9]{15} Firefox/1[0-9]\.[^ ]+$"                                                                    [OR]

    ##
    ##  Made up: Firefox for iOS (FxiOS)
    ##

    ##  Has extra space before Mobile.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU OS 13_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FxiOS/28.0  Mobile/15E148 Safari/605.1.15"             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 15_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FxiOS/99.3  Mobile/15E148 Safari/605.1.15"      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 18_6_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FxiOS/143 Mobile/15E148 Version/17.7"           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 18_7_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FxiOS/144.2  Mobile/15E148 Safari/604.1"        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 26_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FxiOS/146.1  Mobile/15E148 Safari/604.1"          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 26_2 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) FxiOS/146.1  Mobile/15E148 Safari/604.1"          [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 13_5_1 like Mac OS X) AppleWebKit/531.2 (KHTML, like Gecko) FxiOS/18.1k9231.0 Mobile/41Y341 Safari/531.2"      [OR]

    ##
    ##  Made up: Internet Explorer
    ##

    RewriteCond %{HTTP_USER_AGENT}  "compatible; MSIE(2|3|4|5|6|7|8|9)\.00"                                                                                                             [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 11.0; Trident/5.1)"                                                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.1; en-US)"                                                                                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=MSIE"                                                                                                                                             [OR]

    ##
    ##  Made up: Opera
    ##

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Opera/[6-8][0-9]\.0\.0\.0 Safari/[^ ]+$"                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.43 (KHTML, like Gecko) Chrome/134.0.0.0 Safari/537.36 OPR/117.0.0.0"                                [OR]

    ##  Pairing is wrong. Opera 56 is on Chromium 69.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.80 Safari/537.36 OPR/56.0.3051.116"       [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.77 Safari/537.36 OPR/56.0.3051.43"                          [OR]

    ##  Pairing is wrong.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/89.0.4447.51"              [OR]

    ##  Pairing is wrong. Opera 56 is on Chromium 69.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.67 Safari/537.36 OPR/56.0.3051.99"                          [OR]

    ##  Pairing is wrong. Opera 56 is on Chromium 70.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux i686) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729 Safari/537.36 OPR/57.0.3098.106"                            [OR]

    ##  Pairing is wrong.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; WOW64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/89.0.4447.51"                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/89.0.4447.51"                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.6172.7 Safari/537.36 OPR/82.0.4227.33"              [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36 OPR/89.0.4447.51"                           [OR]

    ##
    ##  Made up: Safari
    ##

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^A]+Android[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Safari/1[0-8]\.0\.0\.0 Safari/[^ ]+$"                                    [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((Mac|Win)[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Safari/1[0-8]\.0\.0\.0 Safari/[^ ]+$"                                       [OR]

    ##  Version is just two digits.
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \((i|Mac)[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Version/[0-9]{2}( Mobile/[^ ]+)? Safari/[^ ]+$"                               [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 17_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.3 Mobile Safari/604.1"         [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 18_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile Safari"                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 10; x86) AppleWebKit/537.36 (KHTML, like Gecko) Safari/10.0.0.0 Safari/537.36"                                [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 14_5) Version/17.5 Safari/605.1.15"                                                                [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; U; PPC Mac OS X; en) AppleWebKit/125.2 (KHTML, like Gecko) Safari/85.8"                                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.1.2 Safari/605.1.15"                         [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.3 Safari/605.1.15"                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Safari/107.0 Safari/537.36"                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0) AppleWebKit/537.36 (KHTML, like Gecko) Safari/114.0 Safari/537.36"                                          [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; arm64) AppleWebKit/537.36 (KHTML, like Gecko) Safari/11.0.0.0 Safari/537.36"                      [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Safari/13.0.0.0 Safari/537.36"                        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; x86) AppleWebKit/537.36 (KHTML, like Gecko) Safari/14.0.0.0 Safari/537.36"                        [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPad; CPU OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML like Gecko) Mobile/12A405 Version/7.0 Safari/9537.53"           [OR]

    ##
    ##  Made up: Samsung Internet
    ##

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 12; SAMSUNG SM-A415F) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/23.0 Chrome/115.0.0.0 Mobile Safari/537.3"        [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 14; Galaxy A53) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/18.0 Chrome/133.0.6550.29 Mobile Safari/537.36"         [OR]

    ##
    ##  Made up: Yandex Browser
    ##

    ##  Yandex Browser 22.7 was released in July 2022. Chrome 114 was released in May 2023.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 YaBrowser/22.7.0 Yowser/2.5 Safari/537.36"              [OR]

    ##
    ##  Made up: Other
    ##

    ##  iOS 12 was released in 2018. It has a newer version of WebKit.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 12_4_4 like Mac OS X) AppleWebKit/534.2 (KHTML, like Gecko) CriOS/49.0.824.0 Mobile/33Q443 Safari/534.2"               [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/527  (KHTML, like Gecko, Safari/419.3) Arora/0.6 (Change: )"                  [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0"                                                                                                             [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/123.0.6312.118 Safari/534.24 XiaoMi/MiuiBrowser/14.43.0-gn" [OR]

    ##
    ##  Malformed: Chrome
    ##

    RewriteCond %{HTTP_USER_AGENT}  " Chrome/1[0-9][0-9]\.[^ ]+ /537\.3$"                                                                                                       [OR]

    RewriteCond %{HTTP_USER_AGENT}  "Chrome/[1-9][0-9]\.[^ ]+ Safari/537\.3$"                                                                                                   [OR]
    RewriteCond %{HTTP_USER_AGENT}  "Chrome/1[0-4][0-9]\.[^ ]+ Safari/537\.3$"                                                                                                  [OR]

    RewriteCond %{HTTP_USER_AGENT}  "Chrome/[1-9][0-9]\.[^ ]+ Safari/537\.37$"                                                                                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "Chrome/1[0-4][0-9]\.[^ ]+ Safari/537\.37$"                                                                                                 [OR]

    ##  Misses a space.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36(KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36"                  [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114 Safari/537.36"                                [OR]

    ##  Has stray space in Chrome version.
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4 240.111 Safari/537.36"                               [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\tChrome Generic"        [OR]

    ##
    ##  Malformed: Firefox
    ##

    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Win[^)]+\) Gecko/[^ ]+  Firefox$"                                                                                          [OR]

    ##  Misses dot(s) and digit(s) at the end.
    RewriteCond %{HTTP_USER_AGENT}  "Gecko/[^ ]+ Firefox/1[0-4][0-9]$"                                                                                                          [OR]

    ##  Misses digit(s) at the end.
    RewriteCond %{HTTP_USER_AGENT}  "Gecko/[^ ]+ Firefox/1[0-4][0-9]\.$"                                                                                                        [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0)"                                                                                      [OR]

    ##
    ##  Malformed: Internet Explorer
    ##

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/4.0 (compatible;MSIE 6.0;Windows 98;Q312461)"                                                                                     [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)"                                                                                         [OR]
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;"                                                                          [OR]

    ##
    ##  Malformed: Common
    ##

    ##  Has double space before the Safari part at the end.
    RewriteCond %{HTTP_USER_AGENT}  "  Safari/537\.36$"                                                                                                                         [OR]

    ##  Is truncated.
    RewriteCond %{HTTP_USER_AGENT}  " \(KHTML$"                                                                                                                                 [OR]

    ##
    ##  TO BE MOVED TO APPROPRIATE LOCATIONS
    ##

    RewriteCond %{HTTP_USER_AGENT}  "=Dalvik/2.1.0 (Linux; U; Android 9.0; ZTE BA520 Build/MRA58K)"                                                                             [OR]

    ##  The real YandexBlogs bot: Mozilla/5.0 (compatible; YandexBlogs/0.99; robot; +http://yandex.com/bots)
    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (compatible; YandexBlogs/0.99; robot; C; +http://yandex.com/bots)"                                                            [OR]

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 5.1.1; SM-J111F)"

    ##
    ##  REWRITERULE
    ##

    RewriteRule .* - [R=451,L,E=NOBOT:61000]


  ##
  ##
  ##
  ##  END OF SKIP
  ##
  ##
  ##


##
##
##
##  END OF SKIP
##
##
##
