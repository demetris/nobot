##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Opinionated, Deterministic                                                    ##
##  CLIENT ERROR RESPONSE: 402                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Responses for named tools whose addresses can be banned immediately                           ##
##                                                                                                ##
##  The tools here are not technically different than other HTTP client libraries.                ##
##  They are in this special module because of their popularity with annoying actors.             ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent is of search-engine bot
##    OR User-Agent is of a web browser
##  THEN
##    Skip rules for bannable unwanted tools
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}        "=1"                            [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}      "=1"                            [OR]
RewriteCond %{ENV:UA_IS_WEB_BROWSER}            "=1"

RewriteRule .* - [S=1]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP_USER_AGENT}  "^Apache-HttpClient/4\.5\.\d{1,2} \(Java/1\.8\.0_\d{3}\)$"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Java/1\.8\.0_\d\d\d$"                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(compatible; NetScope/1"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Peach/1"                                                          [OR]

  ##  Wget 1.9 was released in 2003.
  RewriteCond %{HTTP_USER_AGENT}  "=Wget/1.9.1"                                                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=ALittle Client"                                                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=aria2/1.35.0"                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=colly - https://github.com/gocolly/colly/v2"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=capsfusion-downloader"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=datasets/3.4.1; python/3.10.11; huggingface_hub/0.34.4; pyarrow/19.0.1; torch/2.6.0+cu126; jax/0.5.2"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=fastcheck_ultra"                                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=fasthttp"                                                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Go-http-client/1.1"                                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Go-http-client/2.0"                                               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Java/14.0.2"                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=libredtail-http"                                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:72.0) Gecko/20100101 Firefox/72.0 (compatible; mozilla/5.0 (x11; linux x86_64) applewebkit/537.36 (khtml, like gecko) chrome/120.0.0.0 safari/537.36; +https://github.com/rom1504/img2dataset)"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 zgrab/0.x"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=nvdorz"                                                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=parquet-filter-downloader/1.1"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Screaming Frog SEO Spider/19.8"                                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=xfa1"                                                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=xfox-scan/1.0"

  RewriteRule .* - [R=402,L,E=NOBOT:20000]


##
##
##
##  END OF SKIP
##
##
##
