##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Deterministic                                                                 ##
##  CLIENT ERROR RESPONSE: 451                                                                    ##
##                                                                                                ##
##  NOTICE                                                                                        ##
##                                                                                                ##
##  NOT FOR ALL WEB SERVER CONFIGURATIONS!                                                        ##
##  ONLY include this module if HTTP/2 is enabled on the web server.                              ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Response for requests that use HTTP/1.1 over TLS                                              ##
##  even though the agent supports HTTP/2 according to the User-Agent field                       ##
##                                                                                                ##
##  The following support HTTP/2:                                                                 ##
##                                                                                                ##
##  - Chrome 41+                                                                                  ##
##  - Edge 12+                                                                                    ##
##  - Firefox 36+                                                                                 ##
##  - Opera 28+                                                                                   ##
##  - Safari 11+                                                                                  ##
##  - Safari iOS 9+                                                                               ##
##  - Samsung Internet 4+                                                                         ##
##                                                                                                ##
##  IMPORTANT                                                                                     ##
##                                                                                                ##
##  Protocol version is not a sufficient condition here (may have been downgraded by a proxy).    ##
##  For this reason, in most rules more signals are required before denying the request.          ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent string is of a search-engine bot
##    OR connection is not HTTP/1.1 over TLS
##  THEN
##    SKIP checks for HTTP/1.1 over TLS
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}        "=1"                            [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}      "=1"                            [OR]

RewriteCond %{SERVER_PROTOCOL}      "!=HTTP/1.1"                                [OR]
RewriteCond %{REQUEST_SCHEME}       "!=https"

RewriteRule .* - [S=36]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 9
  ##  NO-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "^$"

  RewriteCond %{ENV:UA_IS_SAFARI_11_TO_18}        "=1"                            [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_41_TO_129}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_133}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_17_VER_119}"                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_120}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_36_TO_99}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_134}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FXIOS_IOS_16_0_VER_118}"                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360SE_ON_CHR_41_TO_119}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Accept-NO-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding is missing.
  ##  - Accept value is unexpected for root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{REQUEST_URI}          "=/"

  RewriteCond %{HTTP:Accept-Encoding} "^$"
  RewriteCond %{HTTP:Accept}          "=*/*"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_131}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Language is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${AVAST_DESKTOP_133}"                          [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${BRAVE_DESKTOP_ON_CHR_41_TO_79}"              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${BRAVE_DESKTOP_ON_CHR_80_TO_99}"              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_41_TO_129}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_100}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_115}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_36_TO_139}"                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_145}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_146}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${IRON_ON_CHR_88}"                             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_28_TO_85_ON_CHR_41_TO_99}"     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_11_TO_18}"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_9}"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_16}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_18}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Lin[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/113\.[^ ]+ Mobile Safari/[^ ]+ EdgA/[^ ]+$"                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/133\.[^ ]+ ADG/11\.1\.[^ ]+ Safari/[^ ]+$"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Mac[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Version/18\.3\.1 Safari/[^ ]+ Ddg/18\.3\.1$"                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/79\.[^ ]+ Safari/[^ ]+ AOLShield/[^ ]+$"                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/83\.[^ ]+ Safari/[^ ]+ AOLShield/[^ ]+$"                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) CMAC 2.1.2.01; Chrome/118.0.5993.119 Safari/537.36"    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/133.0.0.0 Safari/537.36 AVG/133.0.0.0"                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/75\.[^ ]+ ADG/11\.0\.[^ ]+ AOLBUILD/11\.0\.[^ ]+ Safari/[^ ]+$"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Accept-UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept value is unexpected for root request.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “br” as well.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{REQUEST_URI}          "=/"

  RewriteCond %{HTTP:Accept}          "=*/*"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, zstd"

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_130}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip”.
  ##  - Accept-Language is missing
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip"

  RewriteCond %{ENV:UA_IS_CHROME_41_TO_199}       "=1"                            [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP}           "=1"                            [OR]
  RewriteCond %{ENV:UA_IS_FIREFOX_36_TO_199}      "=1"                            [OR]
  RewriteCond %{ENV:UA_IS_SAFARI_16_TO_17}        "=1"                            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/85.0.4183.127 Safari/537.36"    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/75\.[^ ]+ Safari/[^ ]+ Vivaldi/2\.6\.[^ ]+$"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) LoiLoNote/15.0.0 Version/17.3.1 Safari/605.1.15"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-UNEXPECTED-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is uncommon.
  ##  - Accept-Language value is uncommon.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "=*"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip;q=1.0"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_145}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip, deflate”.
  ##  - Accept-Language is missing
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_134}"                                 [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_DESKTOP_79_OPEN_ENDED}"               [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_11_TO_18_VER_ANY}"                 [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_114}"                           [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_143}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_147}"                                [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${IRON_ON_CHR_97}"                             [OR]
  
  ##  This is likely fake.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/19.0 Safari/605.1.15"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-SUSPICIOUS-URI
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip, deflate”.
  ##  - Request URI is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"
  RewriteCond %{REQUEST_URI}          "/\.env"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_121}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-UNCOMMON-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Order is uncommon.
  ##  - Accept-Language is uncommon.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "=*"
  RewriteCond %{HTTP:Accept-Encoding} "=br, gzip, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_120}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_17}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-UNCOMMON-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Order is uncommon.
  ##    - Should have “zstd” as well.
  ##  - Accept-Language is uncommon.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "=*"
  RewriteCond %{HTTP:Accept-Encoding} "=br, gzip, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_134}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Order is uncommon.
  ##  - Accept-Language is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=deflate, gzip"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_135}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should not have “zstd”.
  ##  - Accept-Language is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br, zstd"

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_120}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip"

  RewriteCond %{ENV:UA_IS_SAFARI_11_TO_18}        "=1"                            [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_80_TO_122} "=1"                            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_41_TO_139}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_140}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_16_3_VER_122}"                     [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_90}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_100_TO_139}"                         [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_146}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_124_ON_CHR_140}"               [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QQ_BROWSER_8_0_ON_IOS_12_3}"                 [OR]

  ##  TODO. Is this a valid User-Agent?
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.1.1 Mobile/15E148 Safari/604.1"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected
  ##    - Should have more than “gzip”.
  ##  - Request URI is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip"
  RewriteCond %{REQUEST_URI}          "/wp-content/(plugins|themes)/.*\.txt$"

  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_80_TO_122}         "=1"                    [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_121_TO_149}        "=1"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected for “document” Sec-Fetch-Dest.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Sec-Fetch-Dest}  "=document"
  RewriteCond %{HTTP:Accept-Encoding} "=identity"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_90_TO_99}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip”.
  ##  - Three fields of fetch metadata are all missing on root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{HTTP:Accept-Encoding} "=gzip"
  RewriteCond %{REQUEST_URI}          "=/"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_MOBILE_80_ON_CHR_120}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip, deflate”.
  ##  - Three Sec-Fetch-* fields are all missing on root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{REQUEST_URI}          "=/"
  
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_142}"                                 [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_115}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_117_ON_CHR_132}"               [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${SOGOU_MOBILE_5_22_ON_CHR_91}"                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; WOW64; rv:115.12.0) Gecko/20100101 Firefox/115.12.0"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “deflate” as well.
  ##  - Three Sec-Fetch-* fields are all missing on root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, br, zstd"
  RewriteCond %{REQUEST_URI}          "=/"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_134}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip, deflate”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_131}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${OPPO_BROWSER_ON_CHR_76}"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${QQ_BROWSER_8_0_ON_IOS_12_3}"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${VIVO_BROWSER_6_7_ON_AWV_84}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip, deflate”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  RewriteCond %{HTTP:Accept-Encoding} "^(deflate, gzip|gzip, deflate|gzip,deflate)$"

  RewriteCond %{ENV:UA_IS_CHROME_51_TO_129}               "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_138}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_139}"                                 [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_60_TO_69_ON_ANDROID_WV}"              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_15_TO_18}"                              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_44_TO_99}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_139}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_142}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_145}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FXIOS_IOS_17_VER_133}"                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${LBBROWSER_ON_CHR_51_TO_99}"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_38_TO_99_ON_CHR_51_TO_113}"    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_MOBILE_53_ON_CHR_74}"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPPO_BROWSER_ON_CHR_70}"                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360EE_ON_CHR_51_TO_99}"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360SE_ON_CHR_51_TO_99}"                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QQ_BROWSER_10_ON_CHR_51_TO_99}"              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAMSUNG_INTERNET_23_ON_CHR_115}"             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SOGOU_EXPLORER_ON_CHR_51_TO_99}"             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${UC_BROWSER_12_5_ON_CHR_65}"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${WECHAT_ON_CHR_86}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_23_8_ON_CHR_122}"                     [OR]

  ##  Edge iOS (EdgiOS)

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(i[^1]+18[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Version/15\.[^ ]+ EdgiOS/121\.[^ ]+ Mobile/[^ ]+ Safari/[^ ]+$"              [OR]

  ##  OTHER

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/86\.[^ ]+ UBrowser/6\.2\.[^ ]+ Safari/[^ ]+$"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/87\.[^ ]+ UBrowser/6\.2\.[^ ]+ Safari/[^ ]+$"                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/68\.[^ ]+ Mobile Safari/[^ ]+ VivoBrowser/6\.7\.[^ ]+$"       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; MI 9 Build/PKQ1.181121.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/58.0.3174.58 Mobile Safari/537.36 LieBaoFast/5.10.1"             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; MI 9 Build/PKQ1.181121.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/73.0.3683.90 Mobile Safari/537.36 LieBaoFast/5.10.1"             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 7.1.1; OPPO R9sk Build/NMF26F; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/86.0.3493.153 Mobile Safari/537.36 LieBaoFast/5.12.3"            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 7.1.1; OPPO R9sk) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4054.144 Mobile Safari/537.36 EdgA/42.0.2.3819"                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 7.1.1; OPPO R9sk Build/NMF26F) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/74.0.3074.47 Mobile Safari/537.36 360 Alitephone Browser (1.5.0.90/1.0.100.1078) mso_sdk(1.0.0)"       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 9; zh-CN; MI 9 Build/PKQ1.181121.001) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/91.0.3591.81 Quark/3.4.0.113 Mobile Safari/537.36"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Does not have spaces.
  ##    - Should have “zstd” as well.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip,deflate,br"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_135}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “zstd” as well.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_139}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 9
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “zstd” as well.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

  RewriteCond %{ENV:UA_IS_CHROME_123_TO_149}          "=1"                        [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_123_TO_199}    "=1"                        [OR]
  RewriteCond %{ENV:UA_IS_FIREFOX_126_TO_149}         "=1"                        [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; ASUS_I005DA Build/PI; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/133.0.6943.122 Mobile" [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36 LikeWise/96.6.3505.6"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 9
  ##  UNEXPECTED-Encoding-UNEXPECTED-Accept
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “zstd” as well.
  ##  - Accept value is uncommon
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept}          "^text/markdown"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_139}"
  
  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “br” as well.
  ##  - Accept-Language is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, zstd"

  RewriteCond %{ENV:UA_IS_CHROME_123_TO_149}          "=1"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “br” as well.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, zstd"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_140}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Order is unexpected.
  ##    - Should have “zstd” as well.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, br, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_140}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Accept-UNEXPECTED-Encoding
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept value is unexpected for root request.
  ##  - Accept-Encoding value is unexpected for root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{REQUEST_URI}          "=/"

  RewriteCond %{HTTP:Accept}          "=*/*"
  RewriteCond %{HTTP:Accept-Encoding} "=identity"
  
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_88}"                                  [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_92}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_147}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_21_2_YOWSER_ON_CHR_88}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Accept-NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept is missing on root request.
  ##  - Three Sec-Fetch-* fields are all missing on root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{REQUEST_URI}          "=/"

  RewriteCond %{HTTP:Accept}          "^$"

  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_115}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Three Sec-Fetch-* fields are all missing.
  ##
  ##  NOTES
  ##  - Be careful with earlier versions that may not send fetch metadata for files (preloaded) in the the request header.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{HTTP:Accept}          "^(image|text)/"

  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_120}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_120}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_121}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_122}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “zstd” as well.
  ##  - Sec-Fetch-* fields (3) are all missing on root request.
  ##
  ##  NOTES
  ##  - Safari sends these fields as of version 16.4.
  ##  - 2026-01-05. Safari does not send these for downloads (when Accept is just “*/*”).
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"
  
  RewriteCond %{REQUEST_URI}          "=/"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_128}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_140}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Accept-NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept value is unexpected for root request.
  ##  - Sec-Fetch-* fields (3) are all missing on root request.
  ##
  ##  NOTES
  ##  - Safari sends these fields as of version 16.4.
  ##  - 2026-01-05. Safari does not send these for downloads (when Accept is just “*/*”).
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{REQUEST_URI}          "=/"

  RewriteCond %{HTTP:Accept}          "=*/*"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_134}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Sec-Fetch-Dest is missing for root request.
  ##
  ##  NOTES
  ##  - Safari sends this field as of version 16.4.
  ##  - 2026-01-05. Safari does not send this for downloads (when Accept is just “*/*”).
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{REQUEST_URI}          "=/"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_102}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_121}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(Mac[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Version/17\.2 Safari/[^ ]+$"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Accept
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Accept value is unexpected for a web browser.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "=document"
  RewriteCond %{HTTP:Accept}          "=text/x-component"

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2 Safari/605.1.15"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Fetch
  ##
  ##  - HTTP 1.1 over TLS is unexpected.
  ##  - Sec-Fetch-* fields (3) are all missing.
  ##  - Request URI is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"
  
  RewriteCond %{REQUEST_URI}          "^/admin(istrator)?/?$"

  RewriteCond %{HTTP:Sec-Fetch-Dest}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Mode}  "^$"
  RewriteCond %{HTTP:Sec-Fetch-Site}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_121}"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##
  ##  HTTP 1.1 over TLS is unexpected.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{SERVER_PROTOCOL}      "=HTTP/1.1"

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_12_TO_18}"                              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPPO_BROWSER_ON_CHR_48}"                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360EE_ON_CHR_51_TO_99}"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360SE_ON_CHR_51_TO_99}"                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SOGOU_EXPLORER_ON_CHR_41_TO_99}"             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${UC_BROWSER_12_5_ON_CHR_63}"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 9; MI 9 Build/PKQ1.181121.001; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/75.0.4038.134 Mobile Safari/537.36 LieBaoFast/5.10.1"

  RewriteRule .* - [R=451,L,E=NOBOT:41000]


##
##
##
##  END OF SKIP
##
##
##
