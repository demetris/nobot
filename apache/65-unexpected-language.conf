##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Deterministic                                                                 ##
##  CLIENT ERROR RESPONSE: 451                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Response for requests with unexpected Accept-Language                                         ##
##  or unexpected Accept-Language combined with other unexpected field values                     ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent is of search-engine bot
##    OR Accept-Language is not empty
##  THEN
##    Skip rules for empty Accept-Language
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}                "=1"                    [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}              "=1"                    [OR]

RewriteCond %{HTTP:Accept-Language} "!^$"

RewriteRule .* - [S=25]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=*"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_100_TO_109}"                          [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_100_TO_109}"                         [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_16}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding is uncommon.
  ##  - Request method is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=identity"
  RewriteCond %{REQUEST_METHOD}       "=HEAD"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_40_TO_49}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Accept-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept is missing.
  ##  - Request URI ends with “php”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept}          "^$"

  RewriteCond %{REQUEST_URI}          "\.php$"

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_17}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Language-SUSPICIOUS-URI
  ##
  ##  - Accept-Language is missing.
  ##  - Request URI is unexpected.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_URI}          "^/wp-content/(plugins|themes)/.*\.php"

  RewriteCond %{ENV:UA_IS_CHROME_0_TO_122}                "=1"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Language
  ##
  ##  Accept-Language is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{ENV:UA_IS_CHROME_0_TO_69}                 "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_5_TO_10}"                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${INTERNET_EXPLORER_11}"                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_5}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_9}"                            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 4.3; en-us; SM-N900T Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30"                                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 4.4.2; en-US; HM NOTE 1W Build/KOT49H) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 UCBrowser/11.0.5.850 U3/0.8.0 Mobile Safari/534.30"  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.2; rv:22.0) Gecko/20130405 Firefox/23.0"                                                                        [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit/537.36 (KHTML, like Gecko) Brave Chrome/84.0.4147.135 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Brave Chrome/86.0.4240.75 Safari/537.36"           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) Brave Chrome/84.0.4147.125 Safari/537.36"          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.3; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Brave Chrome/86.0.4240.198 Safari/537.36"                 [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Microsoft Windows NT 10.0.16299.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 (FTM)"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have more than “gzip”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip"

  RewriteCond %{ENV:UA_IS_SAFARI_10_TO_26}                "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_0_TO_139}"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_140}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_141}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_60_ON_ANDROID_WV}"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_7_VER_30}"                         [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CRIOS_IOS_12_TO_18_VER_73_TO_149}"           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_15_TO_18}"                              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_80_TO_139}"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_140}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_0_TO_139}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_140}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_141}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_142}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_3_OPEN_ENDED}"                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FXIOS_IOS_14_TO_18_VER_110_TO_139}"          [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${IRON_ON_CHR_74}"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${IRON_ON_CHR_122}"                            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${MI_BROWSER_ON_CHR_71}"                       [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_4_TO_12}"                              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_15_TO_108_ON_CHR_28_TO_122}"   [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${PALEMOON_33_0}"                              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QQ_BROWSER_10_ON_CHR_51_TO_99}"              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_PPC_1_TO_2}"                          [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAMSUNG_INTERNET_1_TO_9}"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SEAMONKEY_2_0_TO_2_49}"                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SOGOU_EXPLORER_ON_CHR_41_TO_99}"             [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${UC_BROWSER_12_3_ON_CHR_57}"                  [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${WECHAT_ON_CHR_66}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_19_7_YOWSER_ON_CHR_75}"               [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_23_1_YOWSER_ON_CHR_108}"              [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_23_7_YOWSER_ON_CHR_114}"              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_24_1_ON_CHR_120}"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_25_8_ON_CHR_138}"                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Opera/"                                       [OR]

  ##  CHROME variable misses these because of the nested parenthesis.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 7.0; Moto G (4)) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.111 Mobile Safari/537.36"            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-US) AppleWebKit/532.2 (KHTML, like Gecko) Chrome/4.0.221.8 Safari/532.2"                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=SAMSUNG-S8000/S8000XXIF3 SHP/VPP/R5 Jasmine/1.0 Nextreaming SMM-MMS/1.2.0 profile/MIDP-2.1 configuration/CLDC-1.1 FirePHP/0.3"            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (BlackBerry; U; BlackBerry 9930; en-US) AppleWebKit/534.11+ (KHTML, like Gecko) Version/7.1.0.267 Mobile Safari/534.11+"      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; U; PPC Mac OS X; de-de) AppleWebKit/412.6 (KHTML, like Gecko)"                                                    [OR]

  ##  Chrome: PATTERNS

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ SUSE/[^ ]+ \(K[^o]+o\) Chrome/[1-6][0-9]\.[^ ]+ Safari/[^ ]+$"                                   [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \(X11[^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/([1-6][0-9]|[1-9])\.[^ ]+ Chromium/[^ ]+ Safari/[^ ]+$"                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 ArchLinux \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/[1-6][0-9]\.[^ ]+ Safari/[^ ]+$"                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 Slackware/[^ ]+ \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/[1-6][0-9]\.[^ ]+$"                                           [OR]

  ##  Chromium: PATTERNS

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Ubuntu Chromium/[^ ]+ Chrome/[0-9]\.[^ ]+ Safari/[^ ]+$"                             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Ubuntu Chromium/[^ ]+ Chrome/[1-6][0-9]\.[^ ]+ Safari/[^ ]+$"                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Ubuntu/[^ ]+ Chromium/[^ ]+ Chrome/[0-9]\.[^ ]+ Safari/[^ ]+$"                       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Ubuntu/[^ ]+ Chromium/[^ ]+ Chrome/[1-6][0-9]\.[^ ]+ Safari/[^ ]+$"                  [OR]

  ##  Firefox: PATTERNS

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ CentOS/[^ ]+ Firefox/[0-9]\.[^ ]+$"                                                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ Fedora/[^ ]+ Firefox/[0-9]\.[^ ]+$"                                                                    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ Gentoo Firefox/[0-9]\.[^ ]+$"                                                                          [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ SUSE/[^ ]+ Firefox/[0-9]\.[^ ]+$"                                                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ Ubuntu/[^ ]+ \([^)]+\) Firefox/[0-9]\.[^ ]+$"                                                          [OR]

  ##  Firefox: Singles

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; en-US; rv:1.9.2.14) Gecko/20110218 AlexaToolbar/alxf-2.0 Firefox/3.6.14"                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.20) Gecko/20110803 AskTbFWV5/3.13.0.17701 Firefox/3.6.20 ( .NET CLR 3.5.30729)"  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.2) Gecko/20100316 AskTbSPC2/3.9.1.14019 Firefox/3.6.2"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows; U; Windows NT 6.1; WOW64; en-US; rv:2.0.4) Gecko/20120718 AskTbAVR-IDW/3.12.5.17700 Firefox/14.0.1"                 [OR]

  ##  Firefox-based: PATTERNS

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) Gecko/[^ ]+ Firefox/[0-9]\.[^ ]+ Iceweasel/[^ ]+$"                                                                 [OR]

  ##  Internet Explorer: Singles

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows Phone 8.1; ARM; Trident/7.0; Touch; rv:11.0; IEMobile/11.0; NOKIA; Lumia 530) like Gecko"                            [OR]

  ##  Maxthon: Singles

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/61.0.3163.79 Safari/537.36 Maxthon/5.2.7.5000"          [OR]

  ##  Opera: Singles

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; en) Opera 8.50"                                                                        [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Opera/106.0.2691.136 Safari/537.36"                                [OR]

  ##  Safari: Singles

  ##  Safari 2, first Safari version for Intel Macs.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; U; Intel Mac OS X; en-us) AppleWebKit/419.2.1 (KHTML, like Gecko) Safari/419.3"                                   [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (SymbianOS/9.1; U; en-us) AppleWebKit/413 (KHTML, like Gecko) Safari/413"                                                     [OR]

  ##  Vivaldi: PATTERNS

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/47\.[^ ]+ Safari/[^ ]+ Vivaldi/1\.0\.[^ ]+$"                                  [OR]

  ##  Yandex Browser: PATTERNS

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/98\.[^ ]+ YaBrowser/22\.3\.[^ ]+ SA/3 Mobile Safari/[^ ]+$"                   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/110\.[^ ]+ YaBrowser/23\.3\.[^ ]+ SA/3 Mobile Safari/[^ ]+$"                  [OR]

  ##  Other: Singles

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (BlackBerry; U; BlackBerry 9800; en) AppleWebKit/534.1  (KHTML, Like Gecko) Version/6.0.0.141 Mobile Safari/534.1"                                                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (iPhone; CPU iPhone OS 12_1_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/16D57 MicroMessenger/7.0.5(0x17000523) NetType/WIFI Language/zh_CN"                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 1.5; en-gb; T-Mobile_G2_Touch Build/CUPCAKE) AppleWebKit/528.5  (KHTML, like Gecko) Version/3.1.2 Mobile Safari/525.20.1"                                      [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 10; zh-Hans-CN; YAL-AL50 Build/HUAWEIYAL-AL50) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.108 Quark/5.6.6.211 Mobile Safari/537.36"   [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 6.0; zh-CN; KNT-UL10 Build/HUAWEIKNT-UL10) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/57.0.2987.108 Quark/3.0.2.943 Mobile Safari/537.36"       [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux 3.8-6.dmz.1-liquorix-686) KHTML/4.8.4 (like Gecko) Konqueror/4.8"                                                                                                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; U; Linux x86_64; en-us) AppleWebKit/537.36 (KHTML, like Gecko)  Chrome/30.0.1599.114 Safari/537.36 Puffin/4.8.0.2965AT"                                                     [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 10; LIO-AN00 Build/HUAWEILIO-AN00; wv) MicroMessenger Weixin QQ AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/78.0.3904.62 XWEB/2692 MMWEBSDK/200901 Mobile Safari/537.36"    [OR]

  ##  Format seems strange.
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; U; Android 2.3.3; en-us ; LS670 Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1/UCBrowser/8.6.1.262/145/355"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/3.0 (compatible; NetPositive/2.1.1; BeOS)"

  ##
  ##  REWRITERULE
  ##

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is wrong.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=none"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_120_TO_129}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is wrong.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=default"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_54}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNCOMMON-Encoding-NO-Language
  ##
  ##  Accept-Language is missing.
  ##  Accept-Encoding value “identity” is uncommon.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=identity"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_31}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should be different on both HTTP and HTTPS.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, br"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_120}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have space after comma.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip,deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_108}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${VIVO_BROWSER_20_2_ON_AWV_62}"                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/600.2.5 (KHTML, like Gecko) Version/8.0.2 Safari/600.2.5 (TestUserAgent)"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: 10
  ##  UNEXPECTED-Accept-UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected for HTTPS.
  ##    - Should have more than or “gzip, deflate”.
  ##  - Accept value is unexpected for image request without referer.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"

  RewriteCond %{REQUEST_URI}          "\.png$"
  RewriteCond %{HTTP_REFERER}         "^$"
  RewriteCond %{HTTP:Accept}          "=*/*"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_144}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected for HTTPS.
  ##    - Should have more than “gzip, deflate”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_SCHEME}       "=https"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate"

  RewriteCond %{ENV:UA_IS_CHROME_51_TO_129}               "=1"                    [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_79_TO_129}         "=1"                    [OR]
  RewriteCond %{ENV:UA_IS_FIREFOX_44_TO_129}              "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_62_ON_CHR_75}"                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_120_ON_CHR_135}"               [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${QIHU_360SE_ON_CHR_51_TO_99}"                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/73\.[^ ]+ ADG/[^ ]+ AOLBUILD/[^ ]+ Safari/[^ ]+$"             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/108\.[^ ]+ Whale/[^ ]+ Safari/[^ ]+$"                         [OR]
  
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 11_1_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36 FS"                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) MicroMessenger Weixin QQ AppleWebKit/[^ ]+ \(K[^o]+o\) Version/4\.0 Chrome/78\.[^ ]+ XWEB/[0-9]+ MMWEBSDK/[0-9]+ Mobile Safari/[^ ]+$"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Order is uncommon.
  ##    - Should not have “br” on plain HTTP.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, br, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_MOBILE_17}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Order is uncommon.
  ##    - Should not have “br” on plain HTTP.
  ##    - Should have “zstd” as well on HTTPS.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, br, deflate"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_136}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected on plain HTTP.
  ##    - Should not have “br”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_SCHEME}       "=http"
  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

  RewriteCond %{ENV:UA_IS_FIREFOX_0_TO_125}               "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_60_TO_69_ON_ANDROID_WV}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should not have “br” on plain HTTP.
  ##    - Should have “zstd” as well on HTTPS.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, br"

  RewriteCond %{ENV:UA_IS_CHROME_123_TO_199}              "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_123_TO_139}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##    - Should have “zstd”, should not have “compress”.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, compress, deflate, br"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_145}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Accept-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept value is unexpected for root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_URI}          "=/"
  RewriteCond %{HTTP:Accept}          "=*/*"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_50}"                                  [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_0_TO_139}"                            [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_91}"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_114}"                           [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_68}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_100_TO_119}"                         [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_125}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_140}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_144}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_5}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Accept-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept is missing for root request.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_URI}          "=/"
  RewriteCond %{HTTP:Accept}          "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_107}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_134}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Encoding-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept-Encoding value is unexpected.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept-Encoding} "=gzip, deflate, identity"

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_91}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Accept-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept is missing.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=http"
  RewriteCond %{REQUEST_METHOD}       "=POST"

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Accept}          "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_134}"                                 [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_134}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Language-SUSPICIOUS-URI
  ##
  ##  - Accept-Language is missing.
  ##  - Request URI is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{REQUEST_URI}          "/\.env$"
  RewriteCond %{HTTP:Accept}          "=*/*"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_86}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  NO-Language-SUSPICIOUS-URI
  ##
  ##  - Accept-Language is missing.
  ##  - Request URI is suspicious.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"

  RewriteCond %{HTTP:Accept}          "=*/*"
  RewriteCond %{REQUEST_URI}          "^/\.(aws|env|git)"

  RewriteCond %{ENV:UA_IS_CHROME_51_TO_129}               "=1"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_77}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  CONFIDENCE: TBD
  ##  UNEXPECTED-Accept-NO-Language
  ##
  ##  - Accept-Language is missing.
  ##  - Accept value is unexpected for Chrome (except for the excluded URIs).
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Accept-Language} "^$"
  RewriteCond %{HTTP:Sec-Fetch-Dest}  "!=empty"

  RewriteCond %{REQUEST_URI}          "!(js|woff|woff2)$"
  RewriteCond %{HTTP:Accept}          "=*/*"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_80_TO_89}"                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_90_TO_99}"

  RewriteRule .* - [R=451,L,E=NOBOT:65000]


##
##
##
##  END OF SKIP
##
##
##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##  CONFIDENCE: TBD
##  UNEXPECTED-Language
##
##  Accept-Language value is unexpected.
##  - Should not have spaces.
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{HTTP:Accept-Language} "=en-US, en; q=0.9, zh-CN; q=0.8, zh; q=0.7"

RewriteCond %{HTTP_USER_AGENT}  "${CHROME_116}"

RewriteRule .* - [R=451,L,E=NOBOT:65000]
