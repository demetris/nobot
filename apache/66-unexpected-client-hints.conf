##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##
##  DETECTION TYPE: Deterministic                                                                 ##
##  CLIENT ERROR RESPONSE: 451                                                                    ##
##                                                                                                ##
##  DESCRIPTION                                                                                   ##
##                                                                                                ##
##  Response for requests with unexpected Sec-CH-* fields                                         ##
##  or unexpected Sec-CH-* fields combined with other unexpected field values                     ##
##                                                                                                ##
##                                                                                                ##
##  ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----    ----  ##


##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
##
##  IF
##    Request is whitelisted by the user
##    OR User-Agent is of search-engine bot
##  THEN
##    Skip all rules for client hints
##
##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

RewriteCond %{ENV:NOBOT_ALLOWED_BY_USER}            "=1"                        [OR]
RewriteCond %{ENV:UA_IS_SEARCH_ENGINE_BOT}          "=1"

RewriteRule .* - [S=76]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  Sec-CH-UA is unexpected.
  ##  - These browsers and versions do not send it.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Sec-CH-UA}   "!^$"

  RewriteCond %{ENV:UA_IS_CHROME_0_TO_89}             "=1"                        [OR]
  RewriteCond %{ENV:UA_IS_FIREFOX_63_TO_149}          "=1"                        [OR]
  RewriteCond %{ENV:UA_IS_SAFARI_10_TO_26}            "=1"                        [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_12_TO_18}"                              [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGIOS_ON_IOS_10_TO_18_VER_ANY}"             [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGIOS_ON_IOS_26_VER_ANY}"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  Sec-CH-UA-Mobile is unexpected.
  ##  - These browsers and versions do not send it.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Sec-CH-UA-Mobile}    "!^$"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_147}"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  Sec-CH-UA-Platform is unexpected.
  ##  - These browsers and versions do not send it.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{HTTP:Sec-CH-UA-Platform}    "!^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_10_TO_92}"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  IF
  ##    Request scheme is HTTPS
  ##  THEN
  ##    Skip rules for client hints over plain HTTP
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}       "=https"

  RewriteRule .* - [S=2]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##  RULE CONFIDENCE: 10
    ##
    ##  Sec-CH-UA is present over plain HTTP.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}       "=http"
    RewriteCond %{HTTP:Sec-CH-UA}       "!^$"

    RewriteCond %{HTTP_USER_AGENT}      "${CHROME_142}"                             [OR]

    RewriteCond %{HTTP_USER_AGENT}      "${EDGE_MOBILE_101}"

    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##  RULE CONFIDENCE: 10
    ##
    ##  Sec-CH-UA-Platform is present over plain HTTP.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}           "=http"
    RewriteCond %{HTTP:Sec-CH-UA-Platform}  "!^$"

    RewriteCond %{HTTP_USER_AGENT}      "${CHROME_110}"                             [OR]

    RewriteCond %{HTTP_USER_AGENT}      "${EDGE_DESKTOP_107}"

    RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##
  ##
  ##
  ##  END OF SKIP
  ##
  ##
  ##


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  IF
  ##    Scheme is plain HTTP
  ##    OR HTTP:Sec-CH-UA is empty
  ##    OR browser is Chrome 143 to 199
  ##    OR browser is Edge Desktop 143 to 199
  ##  THEN
  ##    Skip rules for GREASE value in Chrome 142 and earlier
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}   "=http"                                         [OR]
  RewriteCond %{HTTP:Sec-CH-UA}   "^$"                                            [OR]

  RewriteCond %{ENV:UA_IS_CHROME_143_TO_199}            "=1"                      [OR]
  RewriteCond %{ENV:UA_IS_EDGE_DESKTOP_143_TO_199}      "=1"                      [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_143_TO_199}"

  RewriteRule .* - [S=53]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 90
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_90}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_90}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 91
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not;A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_91}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_91}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 92
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_92}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_92}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 93
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not;A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_93}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_93}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 94
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!";Not A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_94}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_94}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 95
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!";Not A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_95}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_95}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 96
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_96}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_96}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 97
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not;A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_97}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_97}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 98
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_98}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_98}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 99
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_99}"                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_99}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 100
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_100}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_100}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 101
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_101}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_101}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 102
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_102}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_102}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_22_7_YOWSER_ON_CHR_102}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 103
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"\.Not/A\)Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_103}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_103}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 104
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!" Not A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_104}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_104}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_90_ON_CHR_104}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 105
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\)A;Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_105}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_105}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 106
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not;A=Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_106}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_106}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_106}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 107
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not=A\?Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_107}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_107}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 108
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\?A_Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_108}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_108}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 109
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not_A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_109}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_109}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 110
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not A\(Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_110}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_110}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 111
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\(A:Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_111}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_111}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 112
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not:A-Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_112}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_112}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/112\.[^ ]+ Safari/[^ ]+ uacq$"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 113
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not-A\.Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_113}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_113}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 114
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\.A/Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_114}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_114}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_100_ON_CHR_114}"               [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_22_7_YOWSER_ON_CHR_114}"              [OR]
    RewriteCond %{HTTP_USER_AGENT}  "^Mozilla/5\.0 \([^)]+\) AppleWebKit/[^ ]+ \(K[^o]+o\) Chrome/114\.[^ ]+ Safari/[^ ]+ Vivaldi/[^ ]+$"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 115
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not/A\)Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_115}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_115}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 116
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\)A;Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_116}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_116}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_102_ON_CHR_116}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 117
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not;A=Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_117}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_117}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 118
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not=A\?Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_118}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_118}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_118}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 119
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\?A_Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_119}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_119}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_119}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 120
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not_A Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_120}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_120}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${YANDEX_24_1_ON_CHR_120}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 121
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not A\(Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_121}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_121}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_107_ON_CHR_121}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 122
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\(A:Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_122}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_122}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 123
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not:A-Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_123}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_123}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_123}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 124
    ##  GREASE is wrong for Opera 91 (on Chromium 105)
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not-A\.Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_124}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_124}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_91_ON_CHR_105}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 125
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\.A/Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_125}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_125}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_125}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 126
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not/A\)Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_126}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_126}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 127
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\)A;Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_127}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_127}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 128
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not;A=Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_128}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_128}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_114_ON_CHR_128}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 129
    ##  GREASE is wrong for Opera 96 (on Chromium 110)
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not=A\?Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_129}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_129}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_129}"                            [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${OPERA_DESKTOP_96_ON_CHR_110}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 130
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\?A_Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_130}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_130}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 131
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not_A Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_131}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_131}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 132
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not A\(Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_132}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_132}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_132}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 133
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\(A:Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_133}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_133}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 134
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not:A-Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_134}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_134}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 135
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not-A\.Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_135}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_135}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_135}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 136
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\.A/Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_136}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_136}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 137
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not/A\)Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_137}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_137}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_137}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 138
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\)A;Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_138}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_138}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 139
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not;A=Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_139}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_139}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 140
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not=A\?Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_140}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_140}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_140}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 141
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\?A_Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_141}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_141}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_141}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 142
    ##  GREASE is wrong for Opera 126 (Chromium 142)
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not_A Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_142}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_142}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_142}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##
  ##
  ##
  ##  END OF SKIP
  ##
  ##
  ##


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  IF
  ##    Scheme is plain HTTP
  ##    OR Sec-CH-UA is empty
  ##    OR browser is Chrome 0 to 142
  ##    OR browser is Edge Desktop 80 to 142
  ##  THEN
  ##    Skip rules for GREASE value in Chrome 143 and newer
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}   "=http"                                         [OR]
  RewriteCond %{HTTP:Sec-CH-UA}   "^$"                                            [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_90_TO_142}"                           [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_90_TO_142}"                     [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_90_TO_142}"

  RewriteRule .* - [S=3]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 143
    ##  GREASE is wrong for Opera 127 (Chrome 143)
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not A\(Brand";v="24"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_143}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_143}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_143}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 144
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not\(A:Brand";v="8"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_144}"                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_DESKTOP_144}"                           [OR]
    RewriteCond %{HTTP_USER_AGENT}  "${EDGE_MOBILE_144}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  GREASE is wrong for Chrome 145
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}   "=https"
    RewriteCond %{HTTP:Sec-CH-UA}   "!^$"
    RewriteCond %{HTTP:Sec-CH-UA}   '!"Not:A-Brand";v="99"'
    RewriteCond %{HTTP_USER_AGENT}  "${CHROME_145}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##
  ##
  ##
  ##  END OF SKIP
  ##
  ##
  ##


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  Sec-CH-UA-Mobile disagrees with User-Agent.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}           "=https"
  RewriteCond %{HTTP:Sec-CH-UA-Mobile}    "=?0"

  ##  Has additional signal: <deviceModel> and <androidVersion> are not reduced.
  ##  See: https://www.chromium.org/updates/ua-reduction/
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Linux; Android 13; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Mobile Safari/537.36"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  Sec-CH-UA-Mobile is present when it should not be.
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}           "=https"
  RewriteCond %{HTTP:Sec-CH-UA-Mobile}    "=?0"

  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_120}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_121}"                                [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_144}"                                [OR]

  RewriteCond %{HTTP_USER_AGENT}  "${SAFARI_DESKTOP_10_TO_18}"                    [OR]

  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.0 Safari/605.1.15"    [OR]
  RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/26.1 Safari/605.1.15"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##  RULE CONFIDENCE: TBD
  ##
  ##  Client hints (3 fields) are all missing on root request.
  ##  
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}           "=https"
  RewriteCond %{REQUEST_URI}              "=/"
  RewriteCond %{HTTP:Sec-CH-UA}           "^$"
  RewriteCond %{HTTP:Sec-CH-UA-Mobile}    "^$"
  RewriteCond %{HTTP:Sec-CH-UA-Platform}  "^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_124}"                                 [OR]
  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_143}"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  Sec-CH-UA is missing while Sec-CH-UA-Mobile is present.
  ##  
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

  RewriteCond %{REQUEST_SCHEME}           "=https"
  RewriteCond %{HTTP:Sec-CH-UA}           "^$"
  RewriteCond %{HTTP:Sec-CH-UA-Mobile}    "!^$"

  RewriteCond %{HTTP_USER_AGENT}  "${CHROME_116}"

  RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
  ##
  ##  IF
  ##    HTTP:Sec-CH-UA-Platform is empty
  ##  THEN
  ##    Skip rule that checks Sec-CH-UA-Platform
  ##
  ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -


  RewriteCond %{HTTP:Sec-CH-UA}   "^$"

  RewriteRule .* - [S=7]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  Sec-CH-UA-Platform is unexpected.
    ##  - Firefox does not send Sec-CH-UA-Platform.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Sec-CH-UA-Platform}   "!^$"
    RewriteCond %{HTTP_USER_AGENT}  "${FIREFOX_100_TO_149}"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  Sec-CH-UA-Platform value is unexpected.
    ##  - It is unquoted.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}           "=https"
    RewriteCond %{HTTP:Sec-CH-UA-Platform}  "^Windows$"

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36"

    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  Sec-CH-UA-Platform value is unexpected.
    ##  - It is unquoted.
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{REQUEST_SCHEME}           "=https"
    RewriteCond %{HTTP:Sec-CH-UA-Platform}  "^Linux$"

    RewriteCond %{HTTP_USER_AGENT}  "=Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"

    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -
    ##
    ##  There is disagreement between:
    ##  - Sec-CH-UA-Platform
    ##  - User-Agent
    ##
    ##  - - - - - - - - - - - - - - - - - ---- - - - - - - - - - - - - - - - - - - -

    RewriteCond %{HTTP:Sec-CH-UA-Platform}  '^"iOS"$'
    RewriteCond %{HTTP_USER_AGENT}          "Windows NT"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]

    RewriteCond %{HTTP:Sec-CH-UA-Platform}  '^("Linux"|Linux)$'
    RewriteCond %{HTTP_USER_AGENT}          "!Chrome-Lighthouse$"
    RewriteCond %{HTTP_USER_AGENT}          "=MobileSafari/600.1.4 CFNetwork/711.1.12 Darwin/14.0.0"    [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Mac OS X"                                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Windows NT"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]

    RewriteCond %{HTTP:Sec-CH-UA-Platform}  '^"macOS"$'
    RewriteCond %{REMOTE_ADDR}              "!^74\.125\."
    RewriteCond %{HTTP_USER_AGENT}          "!Chrome-Lighthouse$"
    RewriteCond %{HTTP_USER_AGENT}          "Linux x86_64"                                              [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Linux; Android"                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Windows NT"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


    ##  FALSE POSITIVES
    ##  - 2025-10-21. Internet Archive bot. No ID in UA. Detectable only by IP range (has own ASN) and hostname.
    ##      Usually the Internet Archive bot visits with a proper UA of its own.
    RewriteCond %{HTTP:Sec-CH-UA-Platform}  '^"Windows"$'
    RewriteCond %{HTTP_USER_AGENT}          "CrOS x86_64"                                               [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Mac OS X"                                                  [OR]
    RewriteCond %{HTTP_USER_AGENT}          "iPad; CPU OS"                                              [OR]
    RewriteCond %{HTTP_USER_AGENT}          "iPhone OS"                                                 [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Linux; Android"                                            [OR]
    RewriteCond %{HTTP_USER_AGENT}          "Linux x86_64"
    RewriteRule .* - [R=451,L,E=NOBOT:66000]


  ##
  ##
  ##
  ##  END OF SKIP
  ##
  ##
  ##


##
##
##
##  END OF SKIP
##
##
##
