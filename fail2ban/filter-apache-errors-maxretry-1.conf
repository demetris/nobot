[Definition]

#
# "[^ /\.]*": TLS handshake sent to HTTP port (binary data with no spaces/slashes/dots).
#

failregex =
  ^<HOST> - - \[.*\] "[^" ]*" 400
  ^<HOST> - .* "\w+ /\. .* [^"]*" 426
  ^<HOST> - .* "\w+ .* HTTP/1\.0" 400
  ^<HOST> - .* HTTP/[^"]+" 400 \d+ "[^"]*" "-"
  ^<HOST> - .* "\w+ .* HTTP/[^"]+" 403 \d+ "-" "-"
  ^<HOST> - .* "\w+ /cgi-bin/.* HTTP/[^"]+" 400
  ^<HOST> - .* "GET /wp-content/uploads/.* HTTP/[^"]+" 404 \d+ "-" "-"
  ^<HOST> - .* "HEAD .* HTTP/[^"]+" 403 \d+ "-" "-"
  ^<HOST> - .* "PROPFIND .* HTTP/[^"]+" 405 \d+ "[^"]+" "-"

  ##  2025-11-02. 403 + HTTP/1.0 or HTTP/1.1 only.
  ^<HOST> - .* ".*\.env.* HTTP/1\.\d" 403
  ^<HOST> - .* "\w+ /\..* HTTP/1\.\d" 403

ignoreregex =
